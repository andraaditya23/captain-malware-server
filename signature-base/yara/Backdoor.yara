rule php_backdoor_detection
{
    meta:
        author = "Adam_fadli"
        description = "Detects common PHP backdoor patterns"
        reference = "Self"

    strings:
        $php_tag = "<?php"
        $eval = "eval("
        $base64_decode = "base64_decode("
        $str_rot13 = "str_rot13("
        $gzinflate = "gzinflate("

    condition:
        $php_tag and 1 of ($eval, $base64_decode, $str_rot13, $gzinflate)
}